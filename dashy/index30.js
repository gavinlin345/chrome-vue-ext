import{o as fe,l as pt,S as pe,i as me,s as de,ak as At,R as re,eI as $e,ao as be,as as Nt,cp as Tt,aG as Wt,eJ as mt,eK as dt,q as L,c as P,V as M,r as k,u as O,L as f,m as F,v as x,a as w,x as ee,t as b,D as Q,d as j,b as H,eL as Ut,E as ue,N as zt,O as De,P as Le,aD as Vt,a8 as Bt,ar as Ot,W as Re,ea as Qt,a5 as oe,eM as Et,n as V,ae as Ie,an as Kt,a1 as we,bw as Gt,K as A,aa as Pt,Z as J,af as Ft,ag as Ht,b9 as Jt,eN as Zt,eO as Xt,p as _t,I as ce,eP as jt,a7 as ve,eQ as qt,ba as Yt,a2 as xt,aB as en,eR as tn,eS as nn,y as ln,_ as gt,aq as ht,br as rn,ah as an,av as sn,e as on,at as cn,ay as fn,az as un}from"./overlayscrollbars.js";import{C as pn}from"./Card.js";const mn=async({currentLocation:l,unitManuallySet:t,unit:n,savedLocations:e})=>{try{const r=pt(l);if(r)return r;const a=await fe.get("/apps/weather/location");if(!a.data.success)return null;const s=a.data.location;return pt(t)||(s.country==="United States"?n.set("F"):n.set("C")),l.set(s),e.update(i=>i.find(o=>o.id===s.id)?i:[...i,s]),s}catch{return null}},ke=async({updatingWeather:l,weatherData:t,currentLocation:n,unitManuallySet:e,unit:r,savedLocations:a})=>{l.set(!0);const s=await mn({currentLocation:n,unitManuallySet:e,unit:r,savedLocations:a});if(!s){l.set(!1);return}const{lat:i,lon:o}=s,h=await fe.get("/apps/weather/current",{params:{lat:i,lon:o}}).catch(()=>{l.set(!1)});if(!h||!h.data.success){l.set(!1);return}t.set(h.data.data),l.set(!1)};function $t(l,t,n){const e=l.slice();return e[30]=t[n],e}function dn(l){let t;return{c(){t=L("div"),t.textContent="No results found",k(t,"class","flex-center h-full w-full flex-col gap-2 px-4 text-center text-sm")},m(n,e){O(n,t,e)},p:V,i:V,o:V,d(n){n&&Q(t)}}}function _n(l){let t,n,e;return n=new Ie({props:{class:"text-lg"}}),{c(){t=L("div"),P(n.$$.fragment),k(t,"class","flex-center h-full w-full flex-col gap-2 px-4 text-center text-sm")},m(r,a){O(r,t,a),F(n,t,null),e=!0},p:V,i(r){e||(b(n.$$.fragment,r),e=!0)},o(r){w(n.$$.fragment,r),e=!1},d(r){r&&Q(t),j(n)}}}function gn(l){let t;return{c(){t=L("div"),t.textContent="Start typing to see search results",k(t,"class","flex-center h-full w-full flex-col gap-2 px-4 text-center text-sm")},m(n,e){O(n,t,e)},p:V,i:V,o:V,d(n){n&&Q(t)}}}function hn(l){let t,n=l[4],e=[];for(let r=0;r<n.length;r+=1)e[r]=bt($t(l,n,r));return{c(){for(let r=0;r<e.length;r+=1)e[r].c();t=we()},m(r,a){for(let s=0;s<e.length;s+=1)e[s]&&e[s].m(r,a);O(r,t,a)},p(r,a){if(a[0]&536871188){n=r[4];let s;for(s=0;s<n.length;s+=1){const i=$t(r,n,s);e[s]?e[s].p(i,a):(e[s]=bt(i),e[s].c(),e[s].m(t.parentNode,t))}for(;s<e.length;s+=1)e[s].d(1);e.length=n.length}},i:V,o:V,d(r){Gt(e,r),r&&Q(t)}}}function bt(l){var _,C,y,I;let t,n,e=((_=l[30])==null?void 0:_.name)+"",r,a,s,i=(C=l[30])!=null&&C.region?((y=l[30])==null?void 0:y.region)+", ":"",o,h,m=((I=l[30])==null?void 0:I.country)+"",d,u,p,c;function g(){return l[21](l[30],l[29])}return{c(){t=L("button"),n=L("span"),r=A(e),a=M(),s=L("span"),o=A(i),h=M(),d=A(m),u=M(),k(n,"class","max-line-1 text-start text-sm"),k(s,"class","max-line-1 text-start text-xs"),k(t,"class","flex flex-col items-start justify-start bg-black bg-opacity-0 py-1.5 px-3 opacity-80 transition hover:bg-opacity-25 hover:opacity-100")},m($,z){O($,t,z),f(t,n),f(n,r),f(t,a),f(t,s),f(s,o),f(s,h),f(s,d),f(t,u),p||(c=Pt(t,"click",g),p=!0)},p($,z){var q,S,U,N;l=$,z[0]&16&&e!==(e=((q=l[30])==null?void 0:q.name)+"")&&J(r,e),z[0]&16&&i!==(i=(S=l[30])!=null&&S.region?((U=l[30])==null?void 0:U.region)+", ":"")&&J(o,i),z[0]&16&&m!==(m=((N=l[30])==null?void 0:N.country)+"")&&J(d,m)},d($){$&&Q(t),p=!1,c()}}}function $n(l){let t,n,e,r,a,s,i,o,h,m,d,u,p;const c=[hn,gn,_n,dn],g=[];function _($,z){return $[4].length>0?0:$[2].length<3?1:$[6]?2:3}r=_(l),a=g[r]=c[r](l);function C($){l[22]($)}function y($){l[23]($)}let I={placeholder:"Search",size:"md",class:"w-full",animate:!1,delayFocus:500};return l[3]!==void 0&&(I.element=l[3]),l[2]!==void 0&&(I.value=l[2]),o=new zt({props:I}),De.push(()=>Le(o,"element",C)),De.push(()=>Le(o,"value",y)),{c(){t=L("div"),n=L("div"),e=L("div"),a.c(),s=M(),i=L("div"),P(o.$$.fragment),k(e,"class","flex h-full w-full flex-col bg-transparent pb-2"),Vt(n,"flex-grow","1"),k(i,"class","px-2"),k(t,"class","h-60 py-2 flex flex-col")},m($,z){O($,t,z),f(t,n),f(n,e),g[r].m(e,null),f(t,s),f(t,i),F(o,i,null),d=!0,u||(p=Bt(Ot.call(null,n)),u=!0)},p($,z){let q=r;r=_($),r===q?g[r].p($,z):(x(),w(g[q],1,1,()=>{g[q]=null}),ee(),a=g[r],a?a.p($,z):(a=g[r]=c[r]($),a.c()),b(a,1),a.m(e,null));const S={};!h&&z[0]&8&&(h=!0,S.element=$[3],Re(()=>h=!1)),!m&&z[0]&4&&(m=!0,S.value=$[2],Re(()=>m=!1)),o.$set(S)},i($){d||(b(a),b(o.$$.fragment,$),d=!0)},o($){w(a),w(o.$$.fragment,$),d=!1},d($){$&&Q(t),g[r].d(),j(o),u=!1,p()}}}function bn(l){let t,n;return t=new re({props:{icon:Et,size:"xl",tooltip:"Current location"}}),t.$on("click",l[1]),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function vn(l){let t,n;return t=new Ie({props:{class:"text-xl"}}),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function kn(l){let t,n;return t=new re({props:{tooltip:"Refresh",icon:Kt,size:"xl"}}),t.$on("click",l[25]),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function wn(l){let t,n;return t=new Ie({props:{class:"text-xl"}}),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function yn(l){var B;let t,n,e,r,a,s,i,o,h,m,d,u,p,c,g,_,C,y,I,$;e=new At({props:{options:l[7].map(vt),value:((B=l[7].find(l[17]))==null?void 0:B.id)??void 0,placeholder:"Saved places"}}),e.$on("change",l[18]),a=new re({props:{icon:l[7].find(l[19])?$e:be,tooltip:l[7].find(l[20])?"Remove location":"Save location",size:"xl"}}),a.$on("click",function(){Nt(l[0])&&l[0].apply(this,arguments)}),h=new re({props:{icon:Tt,size:"xl",tooltip:"Search"}}),d=new Wt({props:{trigger:"click",placement:"top-end",class:"w-[12rem]",origin:"bottom right",transition:"scale",offset:[0,10],duration:250,$$slots:{default:[$n,({close:v})=>({29:v}),({close:v})=>[v?536870912:0]]},$$scope:{ctx:l}}});const z=[vn,bn],q=[];function S(v,W){return v[5]?0:1}p=S(l),c=q[p]=z[p](l),_=new re({props:{icon:l[9]==="C"?mt:dt,size:"xl",tooltip:"Change unit"}}),_.$on("click",l[24]);const U=[wn,kn],N=[];function E(v,W){return v[10]?0:1}return y=E(l),I=N[y]=U[y](l),{c(){t=L("div"),n=L("div"),P(e.$$.fragment),r=M(),P(a.$$.fragment),s=M(),i=L("div"),o=L("div"),P(h.$$.fragment),m=M(),P(d.$$.fragment),u=M(),c.c(),g=M(),P(_.$$.fragment),C=M(),I.c(),k(n,"class","flex gap-3"),k(i,"class","ml-2 mr-1 flex shrink-0 items-center gap-5 text-lg"),k(t,"class","mt-6 flex w-full items-center justify-between gap-2"),k(t,"id","weather-footer")},m(v,W){O(v,t,W),f(t,n),F(e,n,null),f(n,r),F(a,n,null),f(t,s),f(t,i),f(i,o),F(h,o,null),f(i,m),F(d,i,null),f(i,u),q[p].m(i,null),f(i,g),F(_,i,null),f(i,C),N[y].m(i,null),$=!0},p(v,W){var le;l=v;const te={};W[0]&128&&(te.options=l[7].map(vt)),W[0]&384&&(te.value=((le=l[7].find(l[17]))==null?void 0:le.id)??void 0),e.$set(te);const ne={};W[0]&384&&(ne.icon=l[7].find(l[19])?$e:be),W[0]&384&&(ne.tooltip=l[7].find(l[20])?"Remove location":"Save location"),a.$set(ne);const R={};W[0]&536871260|W[1]&4&&(R.$$scope={dirty:W,ctx:l}),d.$set(R);let Z=p;p=S(l),p===Z?q[p].p(l,W):(x(),w(q[Z],1,1,()=>{q[Z]=null}),ee(),c=q[p],c?c.p(l,W):(c=q[p]=z[p](l),c.c()),b(c,1),c.m(i,g));const ae={};W[0]&512&&(ae.icon=l[9]==="C"?mt:dt),_.$set(ae);let X=y;y=E(l),y===X?N[y].p(l,W):(x(),w(N[X],1,1,()=>{N[X]=null}),ee(),I=N[y],I?I.p(l,W):(I=N[y]=U[y](l),I.c()),b(I,1),I.m(i,null))},i(v){$||(b(e.$$.fragment,v),b(a.$$.fragment,v),b(h.$$.fragment,v),b(d.$$.fragment,v),b(c),b(_.$$.fragment,v),b(I),$=!0)},o(v){w(e.$$.fragment,v),w(a.$$.fragment,v),w(h.$$.fragment,v),w(d.$$.fragment,v),w(c),w(_.$$.fragment,v),w(I),$=!1},d(v){v&&Q(t),j(e),j(a),j(h),j(d),q[p].d(),j(_),N[y].d()}}}const vt=l=>({label:`${l.name}`,id:l.id,value:l.id});function Sn(l,t,n){let e,r,a,s,i;H(l,Ut,R=>n(26,e=R));const{updatingWeather:o,weatherData:h,currentLocation:m,unitManuallySet:d,unit:u,savedLocations:p}=ue("stores");H(l,o,R=>n(10,i=R)),H(l,m,R=>n(8,a=R)),H(l,u,R=>n(9,s=R)),H(l,p,R=>n(7,r=R));let c="",g=[],_=!1,C=!1,y,{addSavedLocation:I}=t;const z=Qt(async()=>{n(6,C=!0);const R=await fe.get("/apps/weather/search",{params:{q:c}}).catch(Z=>{console.log(Z),n(6,C=!1)});R&&(n(4,g=R.data.results??[]),n(6,C=!1))},500),q=async()=>{n(5,_=!0);try{const R=await fe.get("/apps/weather/location",{headers:{Authorization:`Bearer ${e==null?void 0:e.token}`}});return R.data.success?(m.set(R.data.location),n(5,_=!1),R.data.location):null}catch{return n(5,_=!1),null}},S=R=>R.id===(a==null?void 0:a.id),U=R=>{const Z=r.find(ae=>ae.id===R.detail);Z&&oe(m,a=Z,a)},N=R=>R.id===(a==null?void 0:a.id),E=R=>R.id===(a==null?void 0:a.id),B=(R,Z)=>{oe(m,a=R,a),n(2,c=""),Z()};function v(R){y=R,n(3,y)}function W(R){c=R,n(2,c)}const te=()=>{oe(u,s=s==="C"?"F":"C",s)},ne=()=>ke({updatingWeather:o,weatherData:h,currentLocation:m,unitManuallySet:d,unit:u,savedLocations:p});return l.$$set=R=>{"addSavedLocation"in R&&n(0,I=R.addSavedLocation)},l.$$.update=()=>{l.$$.dirty[0]&8&&y&&setTimeout(()=>{y.focus()},100),l.$$.dirty[0]&4&&(c.length>2?(n(6,C=!0),z()):n(4,g=[]))},[I,q,c,y,g,_,C,r,a,s,i,o,h,m,d,u,p,S,U,N,E,B,v,W,te,ne]}class Cn extends pe{constructor(t){super(),me(this,t,Sn,yn,de,{addSavedLocation:0,setCurrentLocation:1},null,[-1,-1])}get setCurrentLocation(){return this.$$.ctx[1]}}function kt(l,t,n){const e=l.slice();return e[9]=t[n],e}function wt(l){let t,n;return t=new re({props:{icon:Zt,class:"vertical-center absolute left-[-0.5rem] text-2xl opacity-0 group-hover:opacity-100"}}),t.$on("click",l[7]),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function Dn(l){let t,n,e,r,a,s,i=l[9].temp[l[2]]+"",o,h,m,d,u,p,c,g=l[9].humidity+"",_,C,y,I,$,z=l[6](l[9].timeStamp,l[3])+"",q,S,U,N=_t(l[9].timeStamp).format("ddd")+"",E,B;return u=new ce({props:{icon:jt,class:"text-sm  text-[#00a8ff]"}}),{c(){t=L("div"),n=L("div"),e=L("img"),a=M(),s=L("span"),o=A(i),h=A("°"),m=M(),d=L("div"),P(u.$$.fragment),p=M(),c=L("span"),_=A(g),C=A("%"),y=M(),I=L("div"),$=L("span"),q=A(z),S=M(),U=L("span"),E=A(N),ve(e.src,r=`/apps/weather/${l[9].icon}.png`)||k(e,"src",r),k(e,"alt","Weather Icon"),k(e,"class","h-6"),k(e,"draggable","false"),k(s,"class","text-sm"),k(n,"class","flex flex-col items-center gap-2"),k(c,"class","text-sm"),k(d,"class","mt-2 flex flex-col items-center gap-4"),k(t,"class","flex flex-col items-center gap-2"),k($,"class","w-12 text-center text-sm font-semibold"),k(U,"class","mt-1 text-xs"),k(I,"class","mt-3 flex flex-col items-center text-sm")},m(v,W){O(v,t,W),f(t,n),f(n,e),f(n,a),f(n,s),f(s,o),f(s,h),f(t,m),f(t,d),F(u,d,null),f(d,p),f(d,c),f(c,_),f(c,C),O(v,y,W),O(v,I,W),f(I,$),f($,q),f(I,S),f(I,U),f(U,E),B=!0},p(v,W){(!B||W&3&&!ve(e.src,r=`/apps/weather/${v[9].icon}.png`))&&k(e,"src",r),(!B||W&7)&&i!==(i=v[9].temp[v[2]]+"")&&J(o,i),(!B||W&3)&&g!==(g=v[9].humidity+"")&&J(_,g),(!B||W&11)&&z!==(z=v[6](v[9].timeStamp,v[3])+"")&&J(q,z),(!B||W&3)&&N!==(N=_t(v[9].timeStamp).format("ddd")+"")&&J(E,N)},i(v){B||(b(u.$$.fragment,v),B=!0)},o(v){w(u.$$.fragment,v),B=!1},d(v){v&&Q(t),j(u),v&&Q(y),v&&Q(I)}}}function yt(l,t){let n,e,r;return e=new pn({props:{class:"no-border flex shrink-0 grow-0 basis-14 flex-col items-center rounded-xl border-[1px] border-solid py-3",$$slots:{default:[Dn]},$$scope:{ctx:t}}}),{key:l,first:null,c(){n=we(),P(e.$$.fragment),this.first=n},m(a,s){O(a,n,s),F(e,a,s),r=!0},p(a,s){t=a;const i={};s&4111&&(i.$$scope={dirty:s,ctx:t}),e.$set(i)},i(a){r||(b(e.$$.fragment,a),r=!0)},o(a){w(e.$$.fragment,a),r=!1},d(a){a&&Q(n),j(e,a)}}}function St(l){let t,n;return t=new re({props:{icon:Xt,class:"vertical-center absolute right-[-0.5rem] text-2xl opacity-0 group-hover:opacity-100"}}),t.$on("click",l[8]),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function Ln(l){var d;let t,n,e=[],r=new Map,a,s,i=l[0]!==1&&wt(l),o=(d=l[1])==null?void 0:d.forecast.slice(l[0]===1?0:(l[0]-1)*5,5*l[0]);const h=u=>u[9].timeStamp;for(let u=0;u<o.length;u+=1){let p=kt(l,o,u),c=h(p);r.set(c,e[u]=yt(c,p))}let m=l[0]!==5&&St(l);return{c(){t=L("div"),i&&i.c(),n=M();for(let u=0;u<e.length;u+=1)e[u].c();a=M(),m&&m.c(),k(t,"class","group relative mt-5 flex h-[max-content] w-full flex-row justify-center gap-3.5")},m(u,p){O(u,t,p),i&&i.m(t,null),f(t,n);for(let c=0;c<e.length;c+=1)e[c]&&e[c].m(t,null);f(t,a),m&&m.m(t,null),s=!0},p(u,[p]){var c;u[0]!==1?i?(i.p(u,p),p&1&&b(i,1)):(i=wt(u),i.c(),b(i,1),i.m(t,n)):i&&(x(),w(i,1,1,()=>{i=null}),ee()),p&79&&(o=(c=u[1])==null?void 0:c.forecast.slice(u[0]===1?0:(u[0]-1)*5,5*u[0]),x(),e=Ft(e,p,h,1,u,o,r,t,Ht,yt,a,kt),ee()),u[0]!==5?m?(m.p(u,p),p&1&&b(m,1)):(m=St(u),m.c(),b(m,1),m.m(t,null)):m&&(x(),w(m,1,1,()=>{m=null}),ee())},i(u){if(!s){b(i);for(let p=0;p<o.length;p+=1)b(e[p]);b(m),s=!0}},o(u){w(i);for(let p=0;p<e.length;p+=1)w(e[p]);w(m),s=!1},d(u){u&&Q(t),i&&i.d();for(let p=0;p<e.length;p+=1)e[p].d();m&&m.d()}}}function Rn(l,t,n){let e,r,a;H(l,Jt,u=>n(3,a=u));const{unit:s,weatherData:i}=ue("stores");H(l,s,u=>n(2,r=u)),H(l,i,u=>n(1,e=u));let o=1;return[o,e,r,a,s,i,(u,p)=>new Date(u).toLocaleTimeString("en-US",{hour:"numeric",hour12:!0}),()=>n(0,o--,o),()=>n(0,o++,o)]}class In extends pe{constructor(t){super(),me(this,t,Rn,Ln,de,{})}}function Ct(l,t,n){const e=l.slice();return e[13]=t[n],e}function Dt(l){let t,n;return t=new Wt({props:{trigger:null,placement:"auto-start",offset:[0,10],transition:"slide",class:"overflow-overlay scrollbar flex max-h-72 w-[12rem] flex-col gap-2.5 overflow-auto rounded-md  px-3 py-3",$$slots:{default:[Mn]},$$scope:{ctx:l}}}),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p(e,r){const a={};r&65551&&(a.$$scope={dirty:r,ctx:e}),t.$set(a)},i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function Lt(l,t){var p,c;let n,e,r=((p=t[13])==null?void 0:p.name)+"",a,s,i=(((c=t[13])==null?void 0:c.stateCode)??t[13].country)+"",o,h,m,d;function u(){return t[11](t[13])}return{key:l,first:null,c(){n=L("button"),e=L("span"),a=A(r),s=A(", "),o=A(i),h=M(),k(e,"class","max-line-1 text-start text-sm"),k(n,"class","flex items-center justify-start opacity-80 transition hover:opacity-100"),this.first=n},m(g,_){O(g,n,_),f(n,e),f(e,a),f(e,s),f(e,o),f(n,h),m||(d=Pt(n,"click",u),m=!0)},p(g,_){var C,y;t=g,_&2&&r!==(r=((C=t[13])==null?void 0:C.name)+"")&&J(a,r),_&2&&i!==(i=(((y=t[13])==null?void 0:y.stateCode)??t[13].country)+"")&&J(o,i)},d(g){g&&Q(n),m=!1,d()}}}function Mn(l){let t=[],n=new Map,e,r=l[1];const a=s=>s[13].id;for(let s=0;s<r.length;s+=1){let i=Ct(l,r,s),o=a(i);n.set(o,t[s]=Lt(o,i))}return{c(){for(let s=0;s<t.length;s+=1)t[s].c();e=we()},m(s,i){for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(s,i);O(s,e,i)},p(s,i){i&1023&&(r=s[1],t=Ft(t,i,a,1,s,r,n,e.parentNode,Yt,Lt,e,Ct))},d(s){for(let i=0;i<t.length;i+=1)t[i].d(s);s&&Q(e)}}}function Wn(l){let t,n,e,r,a,s,i,o,h,m,d;s=new ce({props:{icon:qt,size:"lg"}});function u(g){l[10](g)}let p={placeholder:"Search for your city",size:"md",width:"12rem",animate:!1};l[0]!==void 0&&(p.value=l[0]),o=new zt({props:p}),De.push(()=>Le(o,"value",u));let c=l[1].length>0&&Dt(l);return{c(){t=L("div"),n=L("span"),n.innerHTML="Unable to locate you. <br/> Please find your city below.",e=M(),r=L("div"),a=L("div"),P(s.$$.fragment),i=M(),P(o.$$.fragment),m=M(),c&&c.c(),k(n,"class","mx-12 mb-2 text-center text-base"),k(a,"class","flex items-center gap-4"),k(r,"class","search-button relative mt-4 flex h-8 items-center"),k(t,"class","flex h-40 w-full flex-col items-center justify-center")},m(g,_){O(g,t,_),f(t,n),f(t,e),f(t,r),f(r,a),F(s,a,null),f(a,i),F(o,a,null),f(a,m),c&&c.m(a,null),d=!0},p(g,[_]){const C={};!h&&_&1&&(h=!0,C.value=g[0],Re(()=>h=!1)),o.$set(C),g[1].length>0?c?(c.p(g,_),_&2&&b(c,1)):(c=Dt(g),c.c(),b(c,1),c.m(a,null)):c&&(x(),w(c,1,1,()=>{c=null}),ee())},i(g){d||(b(s.$$.fragment,g),b(o.$$.fragment,g),b(c),d=!0)},o(g){w(s.$$.fragment,g),w(o.$$.fragment,g),w(c),d=!1},d(g){g&&Q(t),j(s),j(o),c&&c.d()}}}function zn(l,t,n){let e,r;const{updatingWeather:a,weatherData:s,currentLocation:i,unitManuallySet:o,unit:h,savedLocations:m}=ue("stores");H(l,i,_=>n(2,e=_)),H(l,m,_=>n(3,r=_));let d="",u=[];const p=async()=>{const _=await fe.get("/apps/weather/search",{params:{q:d}}).catch(C=>{console.log(C)});_&&n(1,u=_.data.results)};function c(_){d=_,n(0,d)}const g=_=>{oe(i,e=_,e),n(0,d=""),ke({updatingWeather:a,weatherData:s,currentLocation:i,unitManuallySet:o,unit:h,savedLocations:m}),m.update(C=>C.find(y=>(y==null?void 0:y.id)===(_==null?void 0:_.id))?C:[_,...C]),oe(m,r=r.slice(0,4),r)};return l.$$.update=()=>{l.$$.dirty&1&&(d.length>2?p():n(1,u=[]))},[d,u,e,r,a,s,i,o,h,m,c,g]}class Pn extends pe{constructor(t){super(),me(this,t,zn,Wn,de,{})}}function Fn(l){let t,n;return t=new Pn({}),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function jn(l){let t,n;return t=new en({}),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function qn(l){var je,qe,Ae,Ne,Te,Ue,Ve,Be,Oe,Qe,Ee,Ke,Ge,He;let t,n,e,r,a=((je=l[0])==null?void 0:je.name)+"",s,i,o=(((qe=l[0])==null?void 0:qe.region)??((Ae=l[0])==null?void 0:Ae.country))+"",h,m,d,u=l[1].filter(l[13]).length>0,p,c,g,_,C,y,I,$,z,q=((Te=(Ne=l[2])==null?void 0:Ne.current)==null?void 0:Te.temp[l[3]])+"",S,U,N,E,B=((Ve=(Ue=l[2])==null?void 0:Ue.current)==null?void 0:Ve.condition)+"",v,W,te=((Be=l[2])==null?void 0:Be.current.feels_like[l[3]])+"",ne,R,Z,ae,X,le,Me,_e,ge=((Qe=(Oe=l[2])==null?void 0:Oe.current)==null?void 0:Qe.humidity)+"",ye,We,ze,se,Pe,Se,he=l[3]==="C"?`${(Ke=(Ee=l[2])==null?void 0:Ee.current)==null?void 0:Ke.wind.kmh} kmh`:`${(He=(Ge=l[2])==null?void 0:Ge.current)==null?void 0:He.wind.mph} mph`,Ce,Fe,Y;e=new ce({props:{icon:qt,class:"mr-3"}});let K=u&&Rt(l);c=new re({props:{icon:l[1].filter(l[15]).length>0?$e:be,tooltip:l[1].filter(l[16]).length>0?"Remove location":"Save location"}}),c.$on("click",l[12]),le=new ce({props:{icon:jt,class:"text-sm "}}),se=new ce({props:{icon:tn,class:"ml-2 text-sm"}});let G=l[4]&&It(l);return{c(){var D,T,ie;t=L("div"),n=L("span"),P(e.$$.fragment),r=M(),s=A(a),i=A(", "),h=A(o),m=M(),d=L("div"),K&&K.c(),p=M(),P(c.$$.fragment),g=M(),_=L("div"),C=L("img"),I=M(),$=L("div"),z=L("span"),S=A(q),U=A("°"),N=M(),E=L("span"),v=A(B),W=A(" and feels like "),ne=A(te),R=A("°"),ae=M(),X=L("div"),P(le.$$.fragment),Me=M(),_e=L("span"),ye=A(ge),We=A("%"),ze=M(),P(se.$$.fragment),Pe=M(),Se=L("span"),Ce=A(he),Fe=M(),G&&G.c(),k(d,"class","ml-3 flex items-center justify-start gap-4 opacity-0 transition group-hover:opacity-100"),k(n,"class","group mb-2 flex items-center text-base"),ve(C.src,y="/apps/weather/"+((T=(D=l[2])==null?void 0:D.current)==null?void 0:T.icon)+".png")||k(C,"src",y),k(C,"alt","weather-icon"),k(C,"class","h-[5.5rem]"),k(C,"draggable","false"),k(z,"class","flex items-end justify-start gap-2 text-4xl font-bold"),k(E,"class","max-line-1 text-base"),k(E,"title",Z="Feels like "+((ie=l[2])==null?void 0:ie.current.feels_like[l[3]])+"°"),k(X,"class","flex items-center gap-3"),k($,"class","flex flex-col justify-start gap-1"),k(_,"class","my-4 flex w-full items-center gap-10"),k(t,"class","flex h-full w-full flex-col px-6")},m(D,T){O(D,t,T),f(t,n),F(e,n,null),f(n,r),f(n,s),f(n,i),f(n,h),f(n,m),f(n,d),K&&K.m(d,null),f(d,p),F(c,d,null),f(t,g),f(t,_),f(_,C),f(_,I),f(_,$),f($,z),f(z,S),f(z,U),f($,N),f($,E),f(E,v),f(E,W),f(E,ne),f(E,R),f($,ae),f($,X),F(le,X,null),f(X,Me),f(X,_e),f(_e,ye),f(_e,We),f(X,ze),F(se,X,null),f(X,Pe),f(X,Se),f(Se,Ce),f(t,Fe),G&&G.m(t,null),Y=!0},p(D,T){var Je,Ze,Xe,Ye,xe,et,tt,nt,lt,rt,at,st,it,ot,ct,ft,ut;(!Y||T&1)&&a!==(a=((Je=D[0])==null?void 0:Je.name)+"")&&J(s,a),(!Y||T&1)&&o!==(o=(((Ze=D[0])==null?void 0:Ze.region)??((Xe=D[0])==null?void 0:Xe.country))+"")&&J(h,o),T&3&&(u=D[1].filter(D[13]).length>0),u?K?(K.p(D,T),T&3&&b(K,1)):(K=Rt(D),K.c(),b(K,1),K.m(d,p)):K&&(x(),w(K,1,1,()=>{K=null}),ee());const ie={};T&3&&(ie.icon=D[1].filter(D[15]).length>0?$e:be),T&3&&(ie.tooltip=D[1].filter(D[16]).length>0?"Remove location":"Save location"),c.$set(ie),(!Y||T&4&&!ve(C.src,y="/apps/weather/"+((xe=(Ye=D[2])==null?void 0:Ye.current)==null?void 0:xe.icon)+".png"))&&k(C,"src",y),(!Y||T&12)&&q!==(q=((tt=(et=D[2])==null?void 0:et.current)==null?void 0:tt.temp[D[3]])+"")&&J(S,q),(!Y||T&4)&&B!==(B=((lt=(nt=D[2])==null?void 0:nt.current)==null?void 0:lt.condition)+"")&&J(v,B),(!Y||T&12)&&te!==(te=((rt=D[2])==null?void 0:rt.current.feels_like[D[3]])+"")&&J(ne,te),(!Y||T&12&&Z!==(Z="Feels like "+((at=D[2])==null?void 0:at.current.feels_like[D[3]])+"°"))&&k(E,"title",Z),(!Y||T&4)&&ge!==(ge=((it=(st=D[2])==null?void 0:st.current)==null?void 0:it.humidity)+"")&&J(ye,ge),(!Y||T&12)&&he!==(he=D[3]==="C"?`${(ct=(ot=D[2])==null?void 0:ot.current)==null?void 0:ct.wind.kmh} kmh`:`${(ut=(ft=D[2])==null?void 0:ft.current)==null?void 0:ut.wind.mph} mph`)&&J(Ce,he),D[4]?G?(G.p(D,T),T&16&&b(G,1)):(G=It(D),G.c(),b(G,1),G.m(t,null)):G&&(x(),w(G,1,1,()=>{G=null}),ee())},i(D){Y||(b(e.$$.fragment,D),b(K),b(c.$$.fragment,D),b(le.$$.fragment,D),b(se.$$.fragment,D),b(G),Y=!0)},o(D){w(e.$$.fragment,D),w(K),w(c.$$.fragment,D),w(le.$$.fragment,D),w(se.$$.fragment,D),w(G),Y=!1},d(D){D&&Q(t),j(e),K&&K.d(),j(c),j(le),j(se),G&&G.d()}}}function Rt(l){let t,n;return t=new re({props:{icon:nn,tooltip:"Change location",class:"ml-2 opacity-0 transition group-hover:opacity-100"}}),t.$on("click",l[14]),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},p:V,i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function It(l){let t,n,e,r,a,s;return n=new In({}),r=new Cn({props:{addSavedLocation:l[12]}}),{c(){t=L("div"),P(n.$$.fragment),e=M(),P(r.$$.fragment),k(t,"class","mt-2 w-full"),k(t,"id","weather-expanded")},m(i,o){O(i,t,o),F(n,t,null),f(t,e),F(r,t,null),s=!0},p:V,i(i){s||(b(n.$$.fragment,i),b(r.$$.fragment,i),i&&ln(()=>{s&&(a||(a=gt(t,ht,{duration:300},!0)),a.run(1))}),s=!0)},o(i){w(n.$$.fragment,i),w(r.$$.fragment,i),i&&(a||(a=gt(t,ht,{duration:300},!1)),a.run(0)),s=!1},d(i){i&&Q(t),j(n),j(r),i&&a&&a.end()}}}function An(l){let t,n,e,r;const a=[qn,jn,Fn],s=[];function i(o,h){return o[0]&&o[2]?0:o[5]?1:2}return n=i(l),e=s[n]=a[n](l),{c(){t=L("div"),e.c(),k(t,"class","app-container flex h-max w-[24rem] flex-col pt-4 pb-3")},m(o,h){O(o,t,h),s[n].m(t,null),r=!0},p(o,[h]){let m=n;n=i(o),n===m?s[n].p(o,h):(x(),w(s[m],1,1,()=>{s[m]=null}),ee(),e=s[n],e?e.p(o,h):(e=s[n]=a[n](o),e.c()),b(e,1),e.m(t,null))},i(o){r||(b(e),r=!0)},o(o){w(e),r=!1},d(o){o&&Q(t),s[n].d()}}}function Nn(l,t,n){let e,r,a,s,i,o;const{updatingWeather:h,weatherData:m,currentLocation:d,unitManuallySet:u,unit:p,savedLocations:c}=ue("stores");H(l,h,S=>n(5,o=S)),H(l,m,S=>n(2,a=S)),H(l,d,S=>n(0,e=S)),H(l,p,S=>n(3,s=S)),H(l,c,S=>n(1,r=S));let g;const _=ue("appView");H(l,_,S=>n(4,i=S)),g=d.subscribe(S=>{ke({updatingWeather:h,weatherData:m,currentLocation:d,unitManuallySet:u,unit:p,savedLocations:c})});const C=setInterval(()=>{e&&ke({updatingWeather:h,weatherData:m,currentLocation:d,unitManuallySet:u,unit:p,savedLocations:c})},1e3*60*10),y=()=>{if(e){if(r.filter(S=>S.id===(e==null?void 0:e.id)).length>0){c.update(S=>S.filter(U=>U.id!==(e==null?void 0:e.id)));return}c.update(S=>[...S,e])}};return xt(()=>{g==null||g(),clearInterval(C)}),[e,r,a,s,i,o,h,m,d,p,c,_,y,S=>S.id!==(e==null?void 0:e.id),()=>{const U=r.findIndex(N=>N.id===(e==null?void 0:e.id))+1;if(U>=r.length){d.set(r[0]);return}d.set(r[U])},S=>S.id===(e==null?void 0:e.id),S=>S.id===(e==null?void 0:e.id)]}class Tn extends pe{constructor(t){super(),me(this,t,Nn,An,de,{})}}function Mt(l){let t,n;return t=new Tn({}),{c(){P(t.$$.fragment)},m(e,r){F(t,e,r),n=!0},i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){w(t.$$.fragment,e),n=!1},d(e){j(t,e)}}}function Un(l){let t,n,e=l[1]&&l[2]&&Mt();return{c(){e&&e.c(),t=we()},m(r,a){e&&e.m(r,a),O(r,t,a),n=!0},p(r,[a]){r[1]&&r[2]?e?a&6&&b(e,1):(e=Mt(),e.c(),b(e,1),e.m(t.parentNode,t)):e&&(x(),w(e,1,1,()=>{e=null}),ee())},i(r){n||(b(e),n=!0)},o(r){w(e),n=!1},d(r){e&&e.d(r),r&&Q(t)}}}function Vn(l,t,n){let e,r=V,a=()=>(r(),r=cn(u,$=>n(1,e=$)),u),s;H(l,rn,$=>n(2,s=$)),l.$$.on_destroy.push(()=>r());let{config:i}=t;const o={path:"user_data/{uid}/profiles/{currentProfile}/apps/"+i.id,currentProfile:an,uid:sn},{create:h,start:m,stop:d,isFetched:u,createPersist:p}=fn(o);a();const c=p("weatherData",null),g=h("location",null),_=h("pinnedLocations",[]),C=h("unit","C"),y=p("unitManuallySet",!1),I=un(!1);return on("stores",{weatherData:c,currentLocation:g,savedLocations:_,unit:C,unitManuallySet:y,updatingWeather:I}),m(),l.$$set=$=>{"config"in $&&n(3,i=$.config)},[u,e,s,i,h,m,d,p,c,g,_,C,y,I]}class Qn extends pe{constructor(t){super(),me(this,t,Vn,Un,de,{config:3,create:4,start:5,stop:6,weatherStoresReady:0,createPersist:7,weatherData:8,currentLocation:9,savedLocations:10,unit:11,unitManuallySet:12,updatingWeather:13})}get create(){return this.$$.ctx[4]}get start(){return this.$$.ctx[5]}get stop(){return this.$$.ctx[6]}get weatherStoresReady(){return this.$$.ctx[0]}get createPersist(){return this.$$.ctx[7]}get weatherData(){return this.$$.ctx[8]}get currentLocation(){return this.$$.ctx[9]}get savedLocations(){return this.$$.ctx[10]}get unit(){return this.$$.ctx[11]}get unitManuallySet(){return this.$$.ctx[12]}get updatingWeather(){return this.$$.ctx[13]}}export{Qn as default};
