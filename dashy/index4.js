import{S as Ee,i as De,s as Ce,U as Xe,q as v,V,c as I,r as b,u as y,L as g,m as S,t as m,a as _,D as T,d as Y,b as R,ah as tn,K as Q,ai as an,aj as fn,p as j,R as ye,T as mt,aX as cn,aa as st,a8 as Ye,ar as et,v as ie,x as se,Z as Te,ab as rt,aY as ot,E as $e,a6 as nn,aZ as un,ad as dn,a1 as Me,aR as Ie,a_ as pn,a9 as tt,a$ as lt,o as qe,b0 as Re,a5 as fe,ac as mn,aG as _n,J as He,n as be,b1 as dt,a7 as We,af as Ze,ag as Ke,aE as gt,b2 as $t,a0 as bt,N as gn,O as ve,P as ke,b3 as $n,W as we,b4 as ht,b5 as vt,b6 as kt,b7 as wt,a3 as nt,F as yt,H as bn,y as ln,_ as it,B as Tt,ak as xe,aD as sn,b8 as rn,ao as hn,an as pt,al as vn,aq as Mt,am as kn,Q as wn,ae as yn,a2 as Tn,aP as Mn,e as on,au as An,av as En,aw as Dn,ax as Cn,ay as In,az as Qe,aB as Sn}from"./overlayscrollbars.js";import{C as Fe}from"./Chip.js";import{C as Yn,T as Nn,D as Un,R as jn,A as Vn}from"./Title.js";import{C as Ln}from"./Card.js";import{I as Rn}from"./IntegrationItem.js";import"./DatePicker.js";import"./TimePicker.js";function On(l){let e;return{c(){e=Q("Connect")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function Pn(l){let e,t,n,i,s,r,c,a,f;return a=new Xe({props:{class:"mt-3 text-base px-4",$$slots:{default:[On]},$$scope:{ctx:l}}}),a.$on("click",l[2]),{c(){e=v("div"),t=v("div"),t.innerHTML=`<img src="/apps/google_calendar.png" class="w-[max] h-[2.5rem] object-cover" alt="Todosit logo"/> 
    <span class="text-2xl font-semibold">Google Calendar</span>`,n=V(),i=v("span"),i.innerHTML="Connect your Google Calendar account to view and manage your events. <br/>",s=V(),r=v("span"),r.textContent="Dashy does not store any of your data.",c=V(),I(a.$$.fragment),b(t,"class","flex-center flex-col gap-6"),b(i,"class","text-base text-center mt-1"),b(r,"class","text-base text-center"),b(e,"class","w-[24rem] h-[24.75rem] px-6 py-4 flex flex-col gap-3 justify-center items-center")},m(o,d){y(o,e,d),g(e,t),g(e,n),g(e,i),g(e,s),g(e,r),g(e,c),S(a,e,null),f=!0},p(o,[d]){const u={};d&8&&(u.$$scope={dirty:d,ctx:o}),a.$set(u)},i(o){f||(m(a.$$.fragment,o),f=!0)},o(o){_(a.$$.fragment,o),f=!1},d(o){o&&T(e),Y(a)}}}function Bn(l,e,t){let n;R(l,tn,r=>t(1,n=r));let{widgetId:i=""}=e;const s=()=>{an({user:fn.currentUser,currentProfile:n,integration:"google_calendar",integration_id:i==="calendar"?"google_calendar":`google_calendar_${i}`})};return l.$$set=r=>{"widgetId"in r&&t(0,i=r.widgetId)},[i,n,s]}class Hn extends Ee{constructor(e){super(),De(this,e,Bn,Pn,Ce,{widgetId:0})}}const{window:Fn}=un;function At(l,e,t){const n=l.slice();return n[30]=e[t],n}function Et(l,e,t){const n=l.slice();return n[33]=e[t],n}function Dt(l){let e,t,n,i,s,r;e=new ye({props:{icon:dn,class:"text-lg",tooltip:"Edit Event"}}),e.$on("click",l[24]);const c=[zn,Gn],a=[];function f(o,d){return o[1]?0:1}return n=f(l),i=a[n]=c[n](l),{c(){I(e.$$.fragment),t=V(),i.c(),s=Me()},m(o,d){S(e,o,d),y(o,t,d),a[n].m(o,d),y(o,s,d),r=!0},p(o,d){let u=n;n=f(o),n===u?a[n].p(o,d):(ie(),_(a[u],1,1,()=>{a[u]=null}),se(),i=a[n],i?i.p(o,d):(i=a[n]=c[n](o),i.c()),m(i,1),i.m(s.parentNode,s))},i(o){r||(m(e.$$.fragment,o),m(i),r=!0)},o(o){_(e.$$.fragment,o),_(i),r=!1},d(o){Y(e,o),o&&T(t),a[n].d(o),o&&T(s)}}}function Gn(l){let e,t,n,i,s;return t=new ye({props:{icon:mn,class:"text-lg",tooltip:"Delete Event"}}),i=new _n({props:{trigger:"click",placement:"bottom-end",origin:"top right",offset:[0,10],$$slots:{default:[qn,({close:r})=>({36:r}),({close:r})=>[0,r?32:0]]},$$scope:{ctx:l}}}),{c(){e=v("div"),I(t.$$.fragment),n=V(),I(i.$$.fragment)},m(r,c){y(r,e,c),S(t,e,null),y(r,n,c),S(i,r,c),s=!0},p(r,c){const a={};c[1]&96&&(a.$$scope={dirty:c,ctx:r}),i.$set(a)},i(r){s||(m(t.$$.fragment,r),m(i.$$.fragment,r),s=!0)},o(r){_(t.$$.fragment,r),_(i.$$.fragment,r),s=!1},d(r){r&&T(e),Y(t),r&&T(n),Y(i,r)}}}function zn(l){let e,t;return e=new Ie({props:{icon:He,class:"text-lg animate-spin"}}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p:be,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function Jn(l){let e;return{c(){e=Q("Yes, delete event")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function qn(l){let e,t,n,i,s;function r(){return l[25](l[36])}return i=new Xe({props:{$$slots:{default:[Jn]},$$scope:{ctx:l}}}),i.$on("click",r),{c(){e=v("div"),t=v("span"),t.textContent="Are you sure?",n=V(),I(i.$$.fragment),b(t,"class","text-base font-semibold"),b(e,"class","flex flex-col gap-2 p-2")},m(c,a){y(c,e,a),g(e,t),g(e,n),S(i,e,null),s=!0},p(c,a){l=c;const f={};a[1]&64&&(f.$$scope={dirty:a,ctx:l}),i.$set(f)},i(c){s||(m(i.$$.fragment,c),s=!0)},o(c){_(i.$$.fragment,c),s=!1},d(c){c&&T(e),Y(i)}}}function Ct(l){let e,t=l[6]?"Now live":`In ${l[4]}`,n;return{c(){e=v("span"),n=Q(t),b(e,"class","text-base")},m(i,s){y(i,e,s),g(e,n)},p(i,s){s[0]&80&&t!==(t=i[6]?"Now live":`In ${i[4]}`)&&Te(n,t)},d(i){i&&T(e)}}}function Wn(l){let e,t,n,i,s,r,c,a,f;n=new Ie({props:{class:"text-lg",icon:dt}}),s=new Fe({props:{class:"flex-center py-1 flex gap-2 text-xs",$$slots:{default:[Zn]},$$scope:{ctx:l}}}),s.$on("click",l[15]);let o=l[2]&&It();return{c(){e=v("div"),t=v("div"),I(n.$$.fragment),i=V(),I(s.$$.fragment),r=V(),o&&o.c(),b(t,"class","flex-center shrink-0"),b(e,"class","flex items-center justify-start gap-3 mt-4")},m(d,u){y(d,e,u),g(e,t),S(n,t,null),g(e,i),S(s,e,null),g(e,r),o&&o.m(e,null),c=!0,a||(f=Ye(tt.call(null,t,"Meeting")),a=!0)},p(d,u){const $={};u[1]&64&&($.$$scope={dirty:u,ctx:d}),s.$set($),d[2]?o?(o.p(d,u),u[0]&4&&m(o,1)):(o=It(),o.c(),m(o,1),o.m(e,null)):o&&(ie(),_(o,1,1,()=>{o=null}),se())},i(d){c||(m(n.$$.fragment,d),m(s.$$.fragment,d),m(o),c=!0)},o(d){_(n.$$.fragment,d),_(s.$$.fragment,d),_(o),c=!1},d(d){d&&T(e),Y(n),Y(s),o&&o.d(),a=!1,f()}}}function Xn(l){let e,t,n,i,s,r,c,a,f;return r=new Fe({props:{class:"flex-center py-1 flex gap-2 text-xs",$$slots:{default:[Kn]},$$scope:{ctx:l}}}),r.$on("click",l[26]),{c(){var o;e=v("div"),t=v("div"),n=v("img"),s=V(),I(r.$$.fragment),We(n.src,i=`/apps/${(o=l[0])==null?void 0:o.meetingProvider}.svg`)||b(n,"src",i),b(n,"class","w-4"),b(n,"alt","Meeting provider icon"),b(t,"class","flex-center shrink-0"),b(e,"class","flex items-center justify-start gap-3 mt-4")},m(o,d){y(o,e,d),g(e,t),g(t,n),g(e,s),S(r,e,null),c=!0,a||(f=Ye(tt.call(null,t,"Meeting")),a=!0)},p(o,d){var $;(!c||d[0]&1&&!We(n.src,i=`/apps/${($=o[0])==null?void 0:$.meetingProvider}.svg`))&&b(n,"src",i);const u={};d[1]&64&&(u.$$scope={dirty:d,ctx:o}),r.$set(u)},i(o){c||(m(r.$$.fragment,o),c=!0)},o(o){_(r.$$.fragment,o),c=!1},d(o){o&&T(e),Y(r),a=!1,f()}}}function Zn(l){let e;return{c(){e=Q("Add meeting")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function It(l){let e,t;return e=new Ie({props:{icon:He,class:"text-lg animate-spin"}}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p:be,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function Kn(l){let e;return{c(){e=Q("Join meeting")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function St(l){let e,t,n,i,s,r,c,a,f,o;n=new Ie({props:{class:"text-lg",icon:pn}});const d=[xn,Qn],u=[];function $(p,E){var N;return((N=p[0])==null?void 0:N.attendees.length)>0?0:p[3]?1:-1}return~(r=$(l))&&(c=u[r]=d[r](l)),{c(){e=v("div"),t=v("div"),I(n.$$.fragment),i=V(),s=v("div"),c&&c.c(),b(t,"class","flex-center shrink-0 mt-1"),b(s,"class","flex flex-wrap gap-2"),b(e,"class","flex items-center justify-start gap-3 mt-4")},m(p,E){y(p,e,E),g(e,t),S(n,t,null),g(e,i),g(e,s),~r&&u[r].m(s,null),a=!0,f||(o=Ye(tt.call(null,t,"Guests")),f=!0)},p(p,E){let N=r;r=$(p),r===N?~r&&u[r].p(p,E):(c&&(ie(),_(u[N],1,1,()=>{u[N]=null}),se()),~r?(c=u[r],c?c.p(p,E):(c=u[r]=d[r](p),c.c()),m(c,1),c.m(s,null)):c=null)},i(p){a||(m(n.$$.fragment,p),m(c),a=!0)},o(p){_(n.$$.fragment,p),_(c),a=!1},d(p){p&&T(e),Y(n),~r&&u[r].d(),f=!1,o()}}}function Qn(l){let e,t;return e=new Fe({props:{class:"flex-center py-1 flex gap-2 text-xs",$$slots:{default:[el]},$$scope:{ctx:l}}}),e.$on("click",l[27]),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p(n,i){const s={};i[1]&64&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function xn(l){var c;let e=[],t=new Map,n,i,s=(c=l[0])==null?void 0:c.attendees;const r=a=>a[33];for(let a=0;a<s.length;a+=1){let f=Et(l,s,a),o=r(f);t.set(o,e[a]=Yt(o,f))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=Me()},m(a,f){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(a,f);y(a,n,f),i=!0},p(a,f){var o;f[0]&1&&(s=(o=a[0])==null?void 0:o.attendees,ie(),e=Ze(e,f,r,1,a,s,t,n.parentNode,Ke,Yt,n,Et),se())},i(a){if(!i){for(let f=0;f<s.length;f+=1)m(e[f]);i=!0}},o(a){for(let f=0;f<e.length;f+=1)_(e[f]);i=!1},d(a){for(let f=0;f<e.length;f+=1)e[f].d(a);a&&T(n)}}}function el(l){let e;return{c(){e=Q("Add guests")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function tl(l){var c,a,f;let e=((c=l[33])==null?void 0:c.email)+"",t,n,i,s,r;return i=new Ie({props:{icon:((a=l[33])==null?void 0:a.responseStatus)==="accepted"?gt:((f=l[33])==null?void 0:f.responseStatus)==="declined"?$t:bt,class:"text-xs ml-1"}}),{c(){t=Q(e),n=V(),I(i.$$.fragment),s=V()},m(o,d){y(o,t,d),y(o,n,d),S(i,o,d),y(o,s,d),r=!0},p(o,d){var $,p,E;(!r||d[0]&1)&&e!==(e=(($=o[33])==null?void 0:$.email)+"")&&Te(t,e);const u={};d[0]&1&&(u.icon=((p=o[33])==null?void 0:p.responseStatus)==="accepted"?gt:((E=o[33])==null?void 0:E.responseStatus)==="declined"?$t:bt),i.$set(u)},i(o){r||(m(i.$$.fragment,o),r=!0)},o(o){_(i.$$.fragment,o),r=!1},d(o){o&&T(t),o&&T(n),Y(i,o),o&&T(s)}}}function Yt(l,e){var s,r,c;let t,n,i;return n=new Fe({props:{class:"text-xs py-1 flex-center gap-1",title:`${(s=e[33])==null?void 0:s.email}`,tooltip:{title:((r=e[33])==null?void 0:r.responseStatus)==="accepted"?"Accepted":((c=e[33])==null?void 0:c.responseStatus)==="declined"?"Declined":"No response",position:"right"},$$slots:{default:[tl]},$$scope:{ctx:e}}}),{key:l,first:null,c(){t=Me(),I(n.$$.fragment),this.first=t},m(a,f){y(a,t,f),S(n,a,f),i=!0},p(a,f){var d,u,$;e=a;const o={};f[0]&1&&(o.title=`${(d=e[33])==null?void 0:d.email}`),f[0]&1&&(o.tooltip={title:((u=e[33])==null?void 0:u.responseStatus)==="accepted"?"Accepted":(($=e[33])==null?void 0:$.responseStatus)==="declined"?"Declined":"No response",position:"right"}),f[0]&1|f[1]&64&&(o.$$scope={dirty:f,ctx:e}),n.$set(o)},i(a){i||(m(n.$$.fragment,a),i=!0)},o(a){_(n.$$.fragment,a),i=!1},d(a){a&&T(t),Y(n,a)}}}function Nt(l){let e,t,n,i,s,r,c,a,f,o;n=new Ie({props:{class:"text-lg",icon:lt}});const d=[ll,nl],u=[];function $(p,E){var N;return((N=p[0])==null?void 0:N.locations.length)>0?0:p[3]?1:-1}return~(r=$(l))&&(c=u[r]=d[r](l)),{c(){e=v("div"),t=v("div"),I(n.$$.fragment),i=V(),s=v("div"),c&&c.c(),b(t,"class","flex-center shrink-0 mt-1"),b(s,"class","flex flex-wrap gap-2"),b(e,"class","flex items-start justify-start gap-3 mt-4")},m(p,E){y(p,e,E),g(e,t),S(n,t,null),g(e,i),g(e,s),~r&&u[r].m(s,null),a=!0,f||(o=Ye(tt.call(null,t,"Location")),f=!0)},p(p,E){let N=r;r=$(p),r===N?~r&&u[r].p(p,E):(c&&(ie(),_(u[N],1,1,()=>{u[N]=null}),se()),~r?(c=u[r],c?c.p(p,E):(c=u[r]=d[r](p),c.c()),m(c,1),c.m(s,null)):c=null)},i(p){a||(m(n.$$.fragment,p),m(c),a=!0)},o(p){_(n.$$.fragment,p),_(c),a=!1},d(p){p&&T(e),Y(n),~r&&u[r].d(),f=!1,o()}}}function nl(l){let e,t;return e=new Fe({props:{class:"flex-center py-1 flex gap-2 text-xs",$$slots:{default:[il]},$$scope:{ctx:l}}}),e.$on("click",l[28]),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p(n,i){const s={};i[1]&64&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ll(l){var c;let e=[],t=new Map,n,i,s=(c=l[0])==null?void 0:c.locations;const r=a=>a[30];for(let a=0;a<s.length;a+=1){let f=At(l,s,a),o=r(f);t.set(o,e[a]=Ut(o,f))}return{c(){for(let a=0;a<e.length;a+=1)e[a].c();n=Me()},m(a,f){for(let o=0;o<e.length;o+=1)e[o]&&e[o].m(a,f);y(a,n,f),i=!0},p(a,f){var o;f[0]&1&&(s=(o=a[0])==null?void 0:o.locations,ie(),e=Ze(e,f,r,1,a,s,t,n.parentNode,Ke,Ut,n,At),se())},i(a){if(!i){for(let f=0;f<s.length;f+=1)m(e[f]);i=!0}},o(a){for(let f=0;f<e.length;f+=1)_(e[f]);i=!1},d(a){for(let f=0;f<e.length;f+=1)e[f].d(a);a&&T(n)}}}function il(l){let e;return{c(){e=Q("Add location")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function sl(l){let e=l[30]+"",t;return{c(){t=Q(e)},m(n,i){y(n,t,i)},p(n,i){i[0]&1&&e!==(e=n[30]+"")&&Te(t,e)},d(n){n&&T(t)}}}function Ut(l,e){let t,n,i;return n=new Fe({props:{class:"text-xs py-1 shrink-0",title:e[30],$$slots:{default:[sl]},$$scope:{ctx:e}}}),{key:l,first:null,c(){t=Me(),I(n.$$.fragment),this.first=t},m(s,r){y(s,t,r),S(n,s,r),i=!0},p(s,r){e=s;const c={};r[0]&1&&(c.title=e[30]),r[0]&1|r[1]&64&&(c.$$scope={dirty:r,ctx:e}),n.$set(c)},i(s){i||(m(n.$$.fragment,s),i=!0)},o(s){_(n.$$.fragment,s),i=!1},d(s){s&&T(t),Y(n,s)}}}function jt(l){var n;let e,t=((n=l[0])==null?void 0:n.body)+"";return{c(){e=v("p"),b(e,"class","text-sm mt-4 google-event-body overflow-hidden border px-3 py-2 curved")},m(i,s){y(i,e,s),e.innerHTML=t},p(i,s){var r;s[0]&1&&t!==(t=((r=i[0])==null?void 0:r.body)+"")&&(e.innerHTML=t)},d(i){i&&T(e)}}}function rl(l){var me,Ae,Le,Oe,Ge,Pe,ze,Be,Je;let e,t,n,i,s,r,c,a,f,o,d,u,$,p=(((me=l[0])==null?void 0:me.subject)||"Untitled Event")+"",E,N,M,C,w,X=j((Ae=l[0])==null?void 0:Ae.startTime).format("ddd, MMM Do YYYY")+"",G,B,z=(Le=l[0])!=null&&Le.isAllDay?"All day":`${j((Oe=l[0])==null?void 0:Oe.startTime).format("h:mm a")} - ${j((Ge=l[0])==null?void 0:Ge.endTime).format("h:mm a")}`,O,Z,J,F,L,te,re,ne,le,D;n=new ye({props:{icon:mt,class:"text-xl"}}),n.$on("click",l[13]),a=new ye({props:{icon:cn,class:"text-lg",tooltip:"View event"}}),a.$on("click",l[23]);let H=l[3]&&Dt(l),q=(l[5]||l[6])&&!((Pe=l[0])!=null&&Pe.isAllDay)&&Ct(l);const pe=[Xn,Wn],U=[];function k(W,_e){var Ne,Ve;return(Ne=W[0])!=null&&Ne.isMeeting&&((Ve=W[0])!=null&&Ve.meetingUrl)?0:W[3]?1:-1}~(J=k(l))&&(F=U[J]=pe[J](l));let h=(((ze=l[0])==null?void 0:ze.attendees.length)>0||l[3])&&St(l),K=(((Be=l[0])==null?void 0:Be.locations.length)>0||l[3])&&Nt(l),ee=((Je=l[0])==null?void 0:Je.body)&&jt(l);return{c(){e=v("div"),t=v("div"),I(n.$$.fragment),i=V(),s=v("span"),s.textContent="View all events",r=V(),c=v("div"),I(a.$$.fragment),f=V(),H&&H.c(),o=V(),d=v("div"),u=v("div"),$=v("span"),E=Q(p),N=V(),M=v("div"),q&&q.c(),C=V(),w=v("span"),G=Q(X),B=Q(", "),O=Q(z),Z=V(),F&&F.c(),L=V(),h&&h.c(),te=V(),K&&K.c(),re=V(),ee&&ee.c(),b(s,"class","text-base"),b(c,"class","flex gap-5 shrink-0 ml-auto"),b(t,"class","flex justify-start items-center gap-3"),b($,"class","text-xl font-bold max-line-2"),b(M,"class","mr-1 flex items-center justify-start gap-3"),b(w,"class","text-sm mt-1"),b(u,"class","flex flex-col mt-4"),b(e,"class","h-full flex flex-col px-3 py-2 overflow-overlay scrollbar")},m(W,_e){y(W,e,_e),g(e,t),S(n,t,null),g(t,i),g(t,s),g(t,r),g(t,c),S(a,c,null),g(c,f),H&&H.m(c,null),g(e,o),g(e,d),g(d,u),g(u,$),g($,E),g(u,N),g(u,M),q&&q.m(M,null),g(u,C),g(u,w),g(w,G),g(w,B),g(w,O),g(u,Z),~J&&U[J].m(u,null),g(u,L),h&&h.m(u,null),g(u,te),K&&K.m(u,null),g(u,re),ee&&ee.m(u,null),ne=!0,le||(D=[st(Fn,"keydown",l[22]),Ye(et.call(null,d))],le=!0)},p(W,_e){var Ve,Se,ce,ue,oe,ae,P,de,he;W[3]?H?(H.p(W,_e),_e[0]&8&&m(H,1)):(H=Dt(W),H.c(),m(H,1),H.m(c,null)):H&&(ie(),_(H,1,1,()=>{H=null}),se()),(!ne||_e[0]&1)&&p!==(p=(((Ve=W[0])==null?void 0:Ve.subject)||"Untitled Event")+"")&&Te(E,p),(W[5]||W[6])&&!((Se=W[0])!=null&&Se.isAllDay)?q?q.p(W,_e):(q=Ct(W),q.c(),q.m(M,null)):q&&(q.d(1),q=null),(!ne||_e[0]&1)&&X!==(X=j((ce=W[0])==null?void 0:ce.startTime).format("ddd, MMM Do YYYY")+"")&&Te(G,X),(!ne||_e[0]&1)&&z!==(z=(ue=W[0])!=null&&ue.isAllDay?"All day":`${j((oe=W[0])==null?void 0:oe.startTime).format("h:mm a")} - ${j((ae=W[0])==null?void 0:ae.endTime).format("h:mm a")}`)&&Te(O,z);let Ne=J;J=k(W),J===Ne?~J&&U[J].p(W,_e):(F&&(ie(),_(U[Ne],1,1,()=>{U[Ne]=null}),se()),~J?(F=U[J],F?F.p(W,_e):(F=U[J]=pe[J](W),F.c()),m(F,1),F.m(u,L)):F=null),((P=W[0])==null?void 0:P.attendees.length)>0||W[3]?h?(h.p(W,_e),_e[0]&9&&m(h,1)):(h=St(W),h.c(),m(h,1),h.m(u,te)):h&&(ie(),_(h,1,1,()=>{h=null}),se()),((de=W[0])==null?void 0:de.locations.length)>0||W[3]?K?(K.p(W,_e),_e[0]&9&&m(K,1)):(K=Nt(W),K.c(),m(K,1),K.m(u,re)):K&&(ie(),_(K,1,1,()=>{K=null}),se()),(he=W[0])!=null&&he.body?ee?ee.p(W,_e):(ee=jt(W),ee.c(),ee.m(u,null)):ee&&(ee.d(1),ee=null)},i(W){ne||(m(n.$$.fragment,W),m(a.$$.fragment,W),m(H),m(F),m(h),m(K),ne=!0)},o(W){_(n.$$.fragment,W),_(a.$$.fragment,W),_(H),_(F),_(h),_(K),ne=!1},d(W){W&&T(e),Y(n),Y(a),H&&H.d(),q&&q.d(),~J&&U[J].d(),h&&h.d(),K&&K.d(),ee&&ee.d(),le=!1,rt(D)}}}function ol(l,e,t){let n,i,s,r,c,a,f,o,d,u,$,p;R(l,ot,D=>t(20,u=D));const{selectedEvent:E,events:N,isEdit:M,calendars:C,widgetId:w,monthlyEvents:X}=$e("stores");R(l,E,D=>t(18,o=D)),R(l,N,D=>t(17,f=D)),R(l,M,D=>t(7,p=D)),R(l,C,D=>t(19,d=D)),R(l,X,D=>t(21,$=D));let G=!1,B=!1;function z(){E.set(null)}const O=()=>{i&&(t(1,G=!0),qe.delete("/integration/google_calendar/event",{params:{id:i.id,calendarId:i.calendarId,widgetId:w==="calendar"?"":w}}).then(()=>{Re("Event deleted","success"),N.update(D=>D.filter(H=>H.id!==i.id)),z()}).catch(D=>{Re("Failed to delete event","error"),console.error(D),t(1,G=!1)}))},Z=()=>{t(2,B=!0);const D={calendarId:i.calendarId,subject:i.subject,startTime:i.startTime,endTime:i.endTime,isAllDay:i.isAllDay,createMeeting:!0,timezone:"UTC"};qe.patch("/integration/google_calendar/event",{...D,id:o},{params:{widgetId:w==="calendar"?"":w}}).then(({data:H})=>{fe(N,f=f.map(q=>q.id===H.event.id?H.event:q),f),fe(N,f=f.sort((q,pe)=>j(q.startTime).diff(j(pe.startTime))),f),t(2,B=!1),Re("Meeting added successfully","success")}).catch(()=>{Re("Failed to add meeting","error"),t(2,B=!1)})},J=D=>{D.key==="Escape"&&z()},F=D=>(D.stopPropagation(),window.open(i==null?void 0:i.url,"_blank")),L=()=>{fe(M,p=!0,p)},te=D=>{D(),O()},re=D=>(D.stopPropagation(),window.open(i==null?void 0:i.meetingUrl,"_blank")),ne=()=>{E.set(i==null?void 0:i.id),M.set(!0)},le=()=>{E.set(i==null?void 0:i.id),M.set(!0)};return l.$$.update=()=>{var D;l.$$.dirty[0]&2097152&&t(16,n=Object.keys($).map(H=>$[H].events).flat()),l.$$.dirty[0]&458753&&t(0,i=(f.find(H=>H.id===o)||n.find(H=>H.id===o))??i??null),l.$$.dirty[0]&1048577&&t(6,s=i&&j(i.startTime).isBefore(u)&&j(i.endTime).isAfter(u)),l.$$.dirty[0]&1048577&&t(5,r=i&&j(i.startTime).isBefore(j().add(6,"hours"))&&j(i.startTime).isAfter(u)),l.$$.dirty[0]&1048577&&t(4,c=i&&nn(j(i.startTime).valueOf()-u.getTime(),{short:!1})),l.$$.dirty[0]&524289&&t(3,a=(D=d.find(H=>H.id===(i==null?void 0:i.calendarId)))==null?void 0:D.canEdit)},[i,G,B,a,c,r,s,p,E,N,M,C,X,z,O,Z,n,f,o,d,u,$,J,F,L,te,re,ne,le]}class al extends Ee{constructor(e){super(),De(this,e,ol,rl,Ce,{},null,[-1,-1])}}function fl(l){let e,t,n,i,s,r,c,a,f;n=new Ie({props:{class:"text-xl",icon:lt}});function o(u){l[1](u)}let d={placeholder:"Add a Location",size:"md",class:"w-full py-2 px-2.5",maxLength:255};return l[0]!==void 0&&(d.value=l[0]),s=new gn({props:d}),ve.push(()=>ke(s,"value",o)),{c(){e=v("div"),t=v("div"),I(n.$$.fragment),i=V(),I(s.$$.fragment),b(t,"class","w-8 h-8 flex items-center justify-start shrink-0"),b(e,"class","flex items-center justify-start gap-4")},m(u,$){y(u,e,$),g(e,t),S(n,t,null),g(e,i),S(s,e,null),c=!0,a||(f=Ye($n.call(null,e)),a=!0)},p(u,[$]){const p={};!r&&$&1&&(r=!0,p.value=u[0],we(()=>r=!1)),s.$set(p)},i(u){c||(m(n.$$.fragment,u),m(s.$$.fragment,u),c=!0)},o(u){_(n.$$.fragment,u),_(s.$$.fragment,u),c=!1},d(u){u&&T(e),Y(n),Y(s),a=!1,f()}}}function cl(l,e,t){let{location:n=""}=e;function i(s){n=s,t(0,n)}return l.$$set=s=>{"location"in s&&t(0,n=s.location)},[n,i]}class ul extends Ee{constructor(e){super(),De(this,e,cl,fl,Ce,{location:0})}}function Vt(l){let e,t,n;function i(r){l[37](r)}let s={};return l[12]!==void 0&&(s.repeat=l[12]),e=new jn({props:s}),ve.push(()=>ke(e,"repeat",i)),{c(){I(e.$$.fragment)},m(r,c){S(e,r,c),n=!0},p(r,c){const a={};!t&&c[0]&4096&&(t=!0,a.repeat=r[12],we(()=>t=!1)),e.$set(a)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){Y(e,r)}}}function Lt(l){let e,t,n,i;function s(a){l[38](a)}function r(a){l[39](a)}let c={};return l[8]!==void 0&&(c.attendees=l[8]),l[11]!==void 0&&(c.sendNotifications=l[11]),e=new Vn({props:c}),ve.push(()=>ke(e,"attendees",s)),ve.push(()=>ke(e,"sendNotifications",r)),{c(){I(e.$$.fragment)},m(a,f){S(e,a,f),i=!0},p(a,f){const o={};!t&&f[0]&256&&(t=!0,o.attendees=a[8],we(()=>t=!1)),!n&&f[0]&2048&&(n=!0,o.sendNotifications=a[11],we(()=>n=!1)),e.$set(o)},i(a){i||(m(e.$$.fragment,a),i=!0)},o(a){_(e.$$.fragment,a),i=!1},d(a){Y(e,a)}}}function Rt(l){let e,t,n;function i(r){l[40](r)}let s={};return l[9]!==void 0&&(s.location=l[9]),e=new ul({props:s}),ve.push(()=>ke(e,"location",i)),{c(){I(e.$$.fragment)},m(r,c){S(e,r,c),n=!0},p(r,c){const a={};!t&&c[0]&512&&(t=!0,a.location=r[9],we(()=>t=!1)),e.$set(a)},i(r){n||(m(e.$$.fragment,r),n=!0)},o(r){_(e.$$.fragment,r),n=!1},d(r){Y(e,r)}}}function Ot(l){let e,t;return e=new ye({props:{icon:l[15]?"tabler:repeat":"tabler:repeat-off",class:"text-xl",tooltip:l[15]?"Don't repeat event":"Repeat Event"}}),e.$on("click",l[44]),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p(n,i){const s={};i[0]&32768&&(s.icon=n[15]?"tabler:repeat":"tabler:repeat-off"),i[0]&32768&&(s.tooltip=n[15]?"Don't repeat event":"Repeat Event"),e.$set(s)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function dl(l){let e,t;return e=new Xe({props:{class:"py-2 px-4",disabled:l[6]||!l[10],$$slots:{default:[ml]},$$scope:{ctx:l}}}),e.$on("click",l[45]),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p(n,i){const s={};i[0]&1088&&(s.disabled=n[6]||!n[10]),i[0]&131072|i[1]&16777216&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function pl(l){let e,t;return e=new Xe({props:{class:"py-2 px-4",$$slots:{default:[_l]},$$scope:{ctx:l}}}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p(n,i){const s={};i[1]&16777216&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ml(l){let e=l[17]?"Update":"Add",t,n;return{c(){t=Q(e),n=Q(" event")},m(i,s){y(i,t,s),y(i,n,s)},p(i,s){s[0]&131072&&e!==(e=i[17]?"Update":"Add")&&Te(t,e)},d(i){i&&T(t),i&&T(n)}}}function _l(l){let e,t,n;return t=new Ie({props:{icon:He,class:"ml-2 animate-spin"}}),{c(){e=Q("Adding "),I(t.$$.fragment)},m(i,s){y(i,e,s),S(t,i,s),n=!0},p:be,i(i){n||(m(t.$$.fragment,i),n=!0)},o(i){_(t.$$.fragment,i),n=!1},d(i){i&&T(e),Y(t,i)}}}function gl(l){let e,t,n,i,s,r,c=l[17]?"editing":"adding",a,f,o,d,u,$,p,E,N,M,C,w,X,G,B,z,O,Z,J,F,L,te,re,ne,le,D,H,q,pe,U,k,h,K,ee,me,Ae,Le,Oe;n=new ye({props:{icon:mt,class:"text-xl"}}),n.$on("click",l[24]);function Ge(A){l[30](A)}let Pe={availbleCalendars:l[16],isHidden:l[16].length===1||l[17]};l[10]!==void 0&&(Pe.calendarId=l[10]),E=new Yn({props:Pe}),ve.push(()=>ke(E,"calendarId",Ge));function ze(A){l[31](A)}let Be={};l[4]!==void 0&&(Be.subject=l[4]),C=new Nn({props:Be}),ve.push(()=>ke(C,"subject",ze));function Je(A){l[32](A)}function W(A){l[33](A)}function _e(A){l[34](A)}function Ne(A){l[35](A)}function Ve(A){l[36](A)}let Se={};l[1]!==void 0&&(Se.startDate=l[1]),l[0]!==void 0&&(Se.startTime=l[0]),l[3]!==void 0&&(Se.endTime=l[3]),l[2]!==void 0&&(Se.isAllDay=l[2]),l[7]!==void 0&&(Se.duration=l[7]),G=new Un({props:Se}),ve.push(()=>ke(G,"startDate",Je)),ve.push(()=>ke(G,"startTime",W)),ve.push(()=>ke(G,"endTime",_e)),ve.push(()=>ke(G,"isAllDay",Ne)),ve.push(()=>ke(G,"duration",Ve));let ce=l[15]&&Vt(l),ue=l[13]&&Lt(l),oe=l[14]&&Rt(l);D=new ye({props:{icon:l[5]?dt:ht,class:"text-xl",tooltip:l[5]?"Remove meeting":"Add meeting"}}),D.$on("click",l[41]),q=new ye({props:{icon:l[13]?vt:kt,class:"text-xl",tooltip:l[13]?"Remove guests":"Add guests"}}),q.$on("click",l[42]),U=new ye({props:{icon:l[14]?lt:wt,class:"text-xl",tooltip:l[14]?"Remove location":"Add location"}}),U.$on("click",l[43]);let ae=!l[17]&&Ot(l);const P=[pl,dl],de=[];function he(A,x){return A[6]?0:1}return ee=he(l),me=de[ee]=P[ee](l),{c(){e=v("div"),t=v("div"),I(n.$$.fragment),i=V(),s=v("span"),r=Q("Exit "),a=Q(c),f=Q(" event"),o=V(),d=v("div"),u=v("div"),$=v("div"),p=v("div"),I(E.$$.fragment),M=V(),I(C.$$.fragment),X=V(),I(G.$$.fragment),F=V(),ce&&ce.c(),L=V(),ue&&ue.c(),te=V(),oe&&oe.c(),re=V(),ne=v("div"),le=v("div"),I(D.$$.fragment),H=V(),I(q.$$.fragment),pe=V(),I(U.$$.fragment),k=V(),ae&&ae.c(),h=V(),K=v("div"),me.c(),b(s,"class","text-base"),b(t,"class","flex justify-start items-center gap-3"),b(p,"class","flex flex-col gap-4"),b(u,"class","flex flex-col h-full overflow-hidden"),nt(u,"opacity-50",l[6]),b(le,"class","flex flex-center gap-7 py-2 px-6 border curved w-max shrink-0"),nt(le,"opacity-50",l[6]),b(K,"class","flex items-center justify-center gap-4 shrink-0"),b(ne,"class","flex flex-row gap-2 justify-between items-center"),b(d,"class","flex flex-col mt-4 gap-4 h-full overflow-hidden"),b(e,"class","flex flex-col px-3 py-2 relative overflow-hidden h-full")},m(A,x){y(A,e,x),g(e,t),S(n,t,null),g(t,i),g(t,s),g(s,r),g(s,a),g(s,f),g(e,o),g(e,d),g(d,u),g(u,$),g($,p),S(E,p,null),g(p,M),S(C,p,null),g(p,X),S(G,p,null),g(p,F),ce&&ce.m(p,null),g(p,L),ue&&ue.m(p,null),g(p,te),oe&&oe.m(p,null),g(d,re),g(d,ne),g(ne,le),S(D,le,null),g(le,H),S(q,le,null),g(le,pe),S(U,le,null),g(le,k),ae&&ae.m(le,null),g(ne,h),g(ne,K),de[ee].m(K,null),Ae=!0,Le||(Oe=[st(window,"keydown",l[29]),Ye(et.call(null,$))],Le=!0)},p(A,x){(!Ae||x[0]&131072)&&c!==(c=A[17]?"editing":"adding")&&Te(a,c);const ge={};x[0]&65536&&(ge.availbleCalendars=A[16]),x[0]&196608&&(ge.isHidden=A[16].length===1||A[17]),!N&&x[0]&1024&&(N=!0,ge.calendarId=A[10],we(()=>N=!1)),E.$set(ge);const Ue={};!w&&x[0]&16&&(w=!0,Ue.subject=A[4],we(()=>w=!1)),C.$set(Ue);const je={};!B&&x[0]&2&&(B=!0,je.startDate=A[1],we(()=>B=!1)),!z&&x[0]&1&&(z=!0,je.startTime=A[0],we(()=>z=!1)),!O&&x[0]&8&&(O=!0,je.endTime=A[3],we(()=>O=!1)),!Z&&x[0]&4&&(Z=!0,je.isAllDay=A[2],we(()=>Z=!1)),!J&&x[0]&128&&(J=!0,je.duration=A[7],we(()=>J=!1)),G.$set(je),A[15]?ce?(ce.p(A,x),x[0]&32768&&m(ce,1)):(ce=Vt(A),ce.c(),m(ce,1),ce.m(p,L)):ce&&(ie(),_(ce,1,1,()=>{ce=null}),se()),A[13]?ue?(ue.p(A,x),x[0]&8192&&m(ue,1)):(ue=Lt(A),ue.c(),m(ue,1),ue.m(p,te)):ue&&(ie(),_(ue,1,1,()=>{ue=null}),se()),A[14]?oe?(oe.p(A,x),x[0]&16384&&m(oe,1)):(oe=Rt(A),oe.c(),m(oe,1),oe.m(p,null)):oe&&(ie(),_(oe,1,1,()=>{oe=null}),se()),(!Ae||x[0]&64)&&nt(u,"opacity-50",A[6]);const at={};x[0]&32&&(at.icon=A[5]?dt:ht),x[0]&32&&(at.tooltip=A[5]?"Remove meeting":"Add meeting"),D.$set(at);const ft={};x[0]&8192&&(ft.icon=A[13]?vt:kt),x[0]&8192&&(ft.tooltip=A[13]?"Remove guests":"Add guests"),q.$set(ft);const ct={};x[0]&16384&&(ct.icon=A[14]?lt:wt),x[0]&16384&&(ct.tooltip=A[14]?"Remove location":"Add location"),U.$set(ct),A[17]?ae&&(ie(),_(ae,1,1,()=>{ae=null}),se()):ae?(ae.p(A,x),x[0]&131072&&m(ae,1)):(ae=Ot(A),ae.c(),m(ae,1),ae.m(le,null)),(!Ae||x[0]&64)&&nt(le,"opacity-50",A[6]);let ut=ee;ee=he(A),ee===ut?de[ee].p(A,x):(ie(),_(de[ut],1,1,()=>{de[ut]=null}),se(),me=de[ee],me?me.p(A,x):(me=de[ee]=P[ee](A),me.c()),m(me,1),me.m(K,null))},i(A){Ae||(m(n.$$.fragment,A),m(E.$$.fragment,A),m(C.$$.fragment,A),m(G.$$.fragment,A),m(ce),m(ue),m(oe),m(D.$$.fragment,A),m(q.$$.fragment,A),m(U.$$.fragment,A),m(ae),m(me),Ae=!0)},o(A){_(n.$$.fragment,A),_(E.$$.fragment,A),_(C.$$.fragment,A),_(G.$$.fragment,A),_(ce),_(ue),_(oe),_(D.$$.fragment,A),_(q.$$.fragment,A),_(U.$$.fragment,A),_(ae),_(me),Ae=!1},d(A){A&&T(e),Y(n),Y(E),Y(C),Y(G),ce&&ce.d(),ue&&ue.d(),oe&&oe.d(),Y(D),Y(q),Y(U),ae&&ae.d(),de[ee].d(),Le=!1,rt(Oe)}}}function $l(l,e,t){var oe,ae;let n,i,s,r,c,a,f;const{isCreate:o,isEdit:d,selectedView:u,selectedEvent:$,events:p,calendars:E,widgetId:N,monthlyEvents:M}=$e("stores");R(l,d,P=>t(17,f=P)),R(l,u,P=>t(49,c=P)),R(l,$,P=>t(48,r=P)),R(l,p,P=>t(47,s=P)),R(l,E,P=>t(28,a=P)),R(l,M,P=>t(46,i=P));const{fetchUpcomingEvents:C,fetchMonthlyEvents:w}=$e("utils"),X=()=>{o.set(!1),d.set(!1)};let G=new Date,B=!1,z=yt(),O=yt(60),Z="",J=!1,F=!1,L=60,te=[],re="",ne=((oe=a.find(P=>P.isDefaultCalendar&&P.canEdit))==null?void 0:oe.id)??((ae=a.filter(P=>P.canEdit)[0])==null?void 0:ae.id)??null,le=!1,D=f&&r?s.find(P=>P.id===r):null,H=null,q=!1,pe=!1,U=!1;D&&(G=new Date(D.startTime),z=j(D.startTime).format("HH:mm"),O=j(D.endTime).format("HH:mm"),Z=D.subject,B=D.isAllDay,J=D.isMeeting,L=bn(z,O),ne=D.calendarId,te=D.attendees??[],re=D.locations[0]??"",re&&(pe=!0),te.length&&(q=!0));const k=P=>{const de=j(G).format("YYYY-MM-DD")+" "+z;t(3,O=j(de).add(L,"minutes").format("HH:mm"))},h=()=>{if(!ne)return;t(6,F=!0);const P={calendarId:ne,subject:Z,startTime:B?j(G).format("YYYY-MM-DD"):j(j(G).format("YYYY-MM-DD")+" "+z).toISOString(),endTime:B?j(G).format("YYYY-MM-DD"):j(j(G).format("YYYY-MM-DD")+" "+z).add(L,"minutes").toISOString(),isAllDay:B,isMeeting:J,timezone:"UTC",attendees:te,sendNotifications:le,location:re,repeat:H};qe.post("/integration/google_calendar/event",P,{params:{widgetId:N==="calendar"?"":N}}).then(async({data:de})=>{var A,x,ge;fe(p,s=[...s,de.event].sort((Ue,je)=>j(Ue.startTime).diff(j(je.startTime))),s);const he=j(de.event.startTime).format("YYYY-MM");(A=i[he])!=null&&A.events&&fe(M,i={...i,[he]:{events:[...(x=i[he])==null?void 0:x.events,de.event].sort((Ue,je)=>j(Ue.startTime).diff(j(je.startTime))),lastUpdated:(ge=i[he])==null?void 0:ge.lastUpdated}},i),H&&(c==="upcoming"?await C():await w()),t(6,F=!1),Re("Event added successfully","success"),X()}).catch(()=>{Re("Failed to add event","error"),t(6,F=!1)})},K=()=>{t(6,F=!0);const P={calendarId:ne,subject:Z,startTime:B?j(G).format("YYYY-MM-DD"):j(j(G).format("YYYY-MM-DD")+" "+z).toISOString(),endTime:B?j(G).format("YYYY-MM-DD"):j(j(G).format("YYYY-MM-DD")+" "+z).add(L,"minutes").toISOString(),isAllDay:B,createMeeting:!(D!=null&&D.isMeeting)&&J,removeMeeting:(D==null?void 0:D.isMeeting)&&!J,timezone:"UTC",attendees:te,sendNotifications:le,location:re,repeat:H};qe.patch("/integration/google_calendar/event",{...P,id:r},{params:{widgetId:N==="calendar"?"":N}}).then(async({data:de})=>{var A,x;fe(p,s=s.map(ge=>ge.id===de.event.id?de.event:ge).sort((ge,Ue)=>j(ge.startTime).diff(j(Ue.startTime))),s);const he=j(de.event.startTime).format("YYYY-MM");(A=i[he])!=null&&A.events&&fe(M,i={...i,[he]:{events:i[he].events.map(ge=>ge.id===de.event.id?de.event:ge).sort((ge,Ue)=>j(ge.startTime).diff(j(Ue.startTime))),lastUpdated:(x=i[he])==null?void 0:x.lastUpdated}},i),t(6,F=!1),Re("Event updated successfully","success"),X()}).catch(()=>{Re("Failed to update event","error"),t(6,F=!1)})},ee=P=>{P.key==="Escape"&&X()};function me(P){ne=P,t(10,ne)}function Ae(P){Z=P,t(4,Z)}function Le(P){G=P,t(1,G)}function Oe(P){z=P,t(0,z)}function Ge(P){O=P,t(3,O)}function Pe(P){B=P,t(2,B)}function ze(P){L=P,t(7,L)}function Be(P){H=P,t(12,H)}function Je(P){te=P,t(8,te)}function W(P){le=P,t(11,le)}function _e(P){re=P,t(9,re)}const Ne=()=>t(5,J=!J),Ve=()=>{t(13,q=!q),t(8,te=q&&f?D.attendees:[])},Se=()=>{t(14,pe=!pe),t(9,re=pe&&f?D.locations[0]:"")},ce=()=>(t(15,U=!U),t(12,H=null)),ue=()=>f?K():h();return l.$$.update=()=>{l.$$.dirty[0]&268435456&&t(16,n=a.filter(P=>P.canEdit)),l.$$.dirty[0]&1&&k()},[z,G,B,O,Z,J,F,L,te,re,ne,le,H,q,pe,U,n,f,d,u,$,p,E,M,X,D,h,K,a,ee,me,Ae,Le,Oe,Ge,Pe,ze,Be,Je,W,_e,Ne,Ve,Se,ce,ue]}class bl extends Ee{constructor(e){super(),De(this,e,$l,gl,Ce,{},null,[-1,-1])}}function Pt(l){let e,t,n,i;return t=new Fe({props:{class:"text-xs",$$slots:{default:[hl]},$$scope:{ctx:l}}}),t.$on("click",l[8]),{c(){e=v("div"),I(t.$$.fragment),b(e,"class","mr-1 flex items-center justify-end")},m(s,r){y(s,e,r),S(t,e,null),i=!0},p(s,r){const c={};r&2058&&(c.$$scope={dirty:r,ctx:s}),t.$set(c)},i(s){i||(m(t.$$.fragment,s),s&&ln(()=>{i&&(n||(n=it(e,Tt,{duration:200},!0)),n.run(1))}),i=!0)},o(s){_(t.$$.fragment,s),s&&(n||(n=it(e,Tt,{duration:200},!1)),n.run(0)),i=!1},d(s){s&&T(e),Y(t),s&&n&&n.end()}}}function hl(l){let e=l[3]?"Now live":`In ${l[1]}`,t;return{c(){t=Q(e)},m(n,i){y(n,t,i)},p(n,i){i&10&&e!==(e=n[3]?"Now live":`In ${n[1]}`)&&Te(t,e)},d(n){n&&T(t)}}}function Bt(l){let e,t,n,i,s;return{c(){var r;e=v("button"),t=v("img"),We(t.src,n=`/apps/${(r=l[0])==null?void 0:r.meetingProvider}.svg`)||b(t,"src",n),b(t,"class","w-6"),b(t,"alt","Meeting provider icon"),b(e,"class","flex-center flex gap-2 text-xs mr-1")},m(r,c){y(r,e,c),g(e,t),i||(s=[Ye(tt.call(null,e,"Join meeting")),st(e,"click",l[9])],i=!0)},p(r,c){var a;c&1&&!We(t.src,n=`/apps/${(a=r[0])==null?void 0:a.meetingProvider}.svg`)&&b(t,"src",n)},d(r){r&&T(e),i=!1,rt(s)}}}function vl(l){var X,G,B,z;let e,t,n=(l[0].subject||"Untitled event")+"",i,s,r,c,a,f=j(l[0].startTime).format("ddd, MMM D")+"",o,d,u=(X=l[0])!=null&&X.isAllDay?"All day":`${l[5]} - ${l[6]}`,$,p,E,N,M,C=(l[2]||l[3])&&!((G=l[0])!=null&&G.isAllDay)&&Pt(l),w=((B=l[0])==null?void 0:B.isMeeting)&&((z=l[0])==null?void 0:z.meetingUrl)&&Bt(l);return{c(){e=v("div"),t=v("span"),i=Q(n),r=V(),c=v("div"),a=v("span"),o=Q(f),d=Q(", "),$=Q(u),p=V(),E=v("div"),C&&C.c(),N=V(),w&&w.c(),b(t,"class","max-line-1 text-left font-semibold"),b(t,"title",s=l[0].subject),b(a,"class","max-line-1 text-start text-xs font-[400]"),b(c,"class","flex items-center gap-4 opacity-70"),b(e,"class","flex flex-col gap-0.5"),b(E,"class","flex items-center justify-end gap-3")},m(O,Z){y(O,e,Z),g(e,t),g(t,i),g(e,r),g(e,c),g(c,a),g(a,o),g(a,d),g(a,$),y(O,p,Z),y(O,E,Z),C&&C.m(E,null),g(E,N),w&&w.m(E,null),M=!0},p(O,Z){var J,F,L,te;(!M||Z&1)&&n!==(n=(O[0].subject||"Untitled event")+"")&&Te(i,n),(!M||Z&1&&s!==(s=O[0].subject))&&b(t,"title",s),(!M||Z&1)&&f!==(f=j(O[0].startTime).format("ddd, MMM D")+"")&&Te(o,f),(!M||Z&1)&&u!==(u=(J=O[0])!=null&&J.isAllDay?"All day":`${O[5]} - ${O[6]}`)&&Te($,u),(O[2]||O[3])&&!((F=O[0])!=null&&F.isAllDay)?C?(C.p(O,Z),Z&13&&m(C,1)):(C=Pt(O),C.c(),m(C,1),C.m(E,N)):C&&(ie(),_(C,1,1,()=>{C=null}),se()),(L=O[0])!=null&&L.isMeeting&&((te=O[0])!=null&&te.meetingUrl)?w?w.p(O,Z):(w=Bt(O),w.c(),w.m(E,null)):w&&(w.d(1),w=null)},i(O){M||(m(C),M=!0)},o(O){_(C),M=!1},d(O){O&&T(e),O&&T(p),O&&T(E),C&&C.d(),w&&w.d()}}}function kl(l){let e,t;return e=new Ln({props:{class:"px-3 py-2 flex gap-4 justify-between items-center",$$slots:{default:[vl]},$$scope:{ctx:l}}}),e.$on("click",l[10]),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p(n,[i]){const s={};i&2063&&(s.$$scope={dirty:i,ctx:n}),e.$set(s)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function wl(l,e,t){let n,i,s,r;R(l,ot,p=>t(7,r=p));let{event:c}=e;const{selectedEvent:a}=$e("stores"),f=j(c.startTime).format("h:mm A"),o=j(c.endTime).format("h:mm A"),d=p=>(p.stopPropagation(),window.open(c==null?void 0:c.url,"_blank")),u=p=>(p.stopPropagation(),window.open(c==null?void 0:c.meetingUrl,"_blank")),$=()=>a.set(c.id);return l.$$set=p=>{"event"in p&&t(0,c=p.event)},l.$$.update=()=>{l.$$.dirty&129&&t(3,n=j(c.startTime).isBefore(r)&&j(c.endTime).isAfter(r)),l.$$.dirty&129&&t(2,i=j(c.startTime).isBefore(j().add(6,"hours"))&&j(c.startTime).isAfter(r)),l.$$.dirty&129&&t(1,s=nn(j(c.startTime).valueOf()-r.getTime(),{short:!0}))},[c,s,i,n,a,f,o,r,d,u,$]}class _t extends Ee{constructor(e){super(),De(this,e,wl,kl,Ce,{event:0})}}function Ht(l,e,t){const n=l.slice();return n[15]=e[t],n}function yl(l){let e,t,n=[],i=new Map,s,r,c,a=l[3][l[2]].events.sort(Gt);const f=o=>o[15].id;for(let o=0;o<a.length;o+=1){let d=Ht(l,a,o),u=f(d);i.set(u,n[o]=Ft(u,d))}return{c(){e=v("div"),t=v("div");for(let o=0;o<n.length;o+=1)n[o].c();b(t,"class","flex flex-col gap-2 h-full"),sn(e,"width","100%")},m(o,d){y(o,e,d),g(e,t);for(let u=0;u<n.length;u+=1)n[u]&&n[u].m(t,null);s=!0,r||(c=Ye(et.call(null,e)),r=!0)},p(o,d){d&12&&(a=o[3][o[2]].events.sort(Gt),ie(),n=Ze(n,d,f,1,o,a,i,t,Ke,Ft,null,Ht),se())},i(o){if(!s){for(let d=0;d<a.length;d+=1)m(n[d]);s=!0}},o(o){for(let d=0;d<n.length;d+=1)_(n[d]);s=!1},d(o){o&&T(e);for(let d=0;d<n.length;d+=1)n[d].d();r=!1,c()}}}function Tl(l){let e,t,n,i,s,r,c;return t=new Ie({props:{icon:rn,class:"text-5xl shrink-0"}}),r=new Xe({props:{class:"mt-4",$$slots:{default:[Al]},$$scope:{ctx:l}}}),r.$on("click",l[11]),{c(){e=v("div"),I(t.$$.fragment),n=V(),i=v("span"),i.textContent="No events within this month",s=V(),I(r.$$.fragment),b(i,"class","text-lg flex-center gap-4 mt-6"),b(e,"class","flex-center flex-col w-full h-full")},m(a,f){y(a,e,f),S(t,e,null),g(e,n),g(e,i),g(e,s),S(r,e,null),c=!0},p(a,f){const o={};f&262144&&(o.$$scope={dirty:f,ctx:a}),r.$set(o)},i(a){c||(m(t.$$.fragment,a),m(r.$$.fragment,a),c=!0)},o(a){_(t.$$.fragment,a),_(r.$$.fragment,a),c=!1},d(a){a&&T(e),Y(t),Y(r)}}}function Ml(l){let e,t,n,i,s,r,c,a;return c=new Ie({props:{icon:He,class:"animate-spin text-2xl"}}),{c(){e=v("div"),t=v("img"),i=V(),s=v("span"),r=Q("Looking for events "),I(c.$$.fragment),We(t.src,n="/apps/google_calendar.png")||b(t,"src",n),b(t,"class","w-10 h-10"),b(t,"alt","Google Calendar logo"),b(s,"class","text-lg flex-center gap-4 mt-6"),b(e,"class","flex-center flex-col w-full h-full")},m(f,o){y(f,e,o),g(e,t),g(e,i),g(e,s),g(s,r),S(c,s,null),a=!0},p:be,i(f){a||(m(c.$$.fragment,f),a=!0)},o(f){_(c.$$.fragment,f),a=!1},d(f){f&&T(e),Y(c)}}}function Ft(l,e){let t,n,i;return n=new _t({props:{event:e[15]}}),{key:l,first:null,c(){t=Me(),I(n.$$.fragment),this.first=t},m(s,r){y(s,t,r),S(n,s,r),i=!0},p(s,r){e=s;const c={};r&12&&(c.event=e[15]),n.$set(c)},i(s){i||(m(n.$$.fragment,s),i=!0)},o(s){_(n.$$.fragment,s),i=!1},d(s){s&&T(t),Y(n,s)}}}function Al(l){let e;return{c(){e=Q("Add event")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function El(l){let e,t,n,i,s,r,c,a,f,o,d;function u(w){l[9](w)}let $={options:l[7]};l[0]!==void 0&&($.value=l[0]),n=new xe({props:$}),ve.push(()=>ke(n,"value",u));function p(w){l[10](w)}let E={options:l[8]};l[1]!==void 0&&(E.value=l[1]),r=new xe({props:E}),ve.push(()=>ke(r,"value",p));const N=[Ml,Tl,yl],M=[];function C(w,X){return w[3][w[2]]===void 0?0:w[3][w[2]].events.length===0?1:2}return f=C(l),o=M[f]=N[f](l),{c(){e=v("div"),t=v("div"),I(n.$$.fragment),s=V(),I(r.$$.fragment),a=V(),o.c(),b(t,"class","flex flex-row gap-2 mb-3"),b(e,"class","flex items-start justify-start h-full flex-col overflow-hidden")},m(w,X){y(w,e,X),g(e,t),S(n,t,null),g(t,s),S(r,t,null),g(e,a),M[f].m(e,null),d=!0},p(w,[X]){const G={};!i&&X&1&&(i=!0,G.value=w[0],we(()=>i=!1)),n.$set(G);const B={};!c&&X&2&&(c=!0,B.value=w[1],we(()=>c=!1)),r.$set(B);let z=f;f=C(w),f===z?M[f].p(w,X):(ie(),_(M[z],1,1,()=>{M[z]=null}),se(),o=M[f],o?o.p(w,X):(o=M[f]=N[f](w),o.c()),m(o,1),o.m(e,null))},i(w){d||(m(n.$$.fragment,w),m(r.$$.fragment,w),m(o),d=!0)},o(w){_(n.$$.fragment,w),_(r.$$.fragment,w),_(o),d=!1},d(w){w&&T(e),Y(n),Y(r),M[f].d()}}}const Gt=(l,e)=>l.startTime.localeCompare(e.startTime);function Dl(l,e,t){let n,i;const{monthlyEvents:s,selectedMonth:r,isCreate:c}=$e("stores");R(l,s,M=>t(3,i=M)),R(l,r,M=>t(2,n=M)),$e("alwaysAppView");const{fetchMonthlyEvents:a}=$e("utils");let f=n.split("-")[1],o=n.split("-")[0];const d=()=>{var M;((M=i[n])==null?void 0:M.lastUpdated)>Date.now()-1e3*60*10||a()},u=[{label:"January",value:"01"},{label:"February",value:"02"},{label:"March",value:"03"},{label:"April",value:"04"},{label:"May",value:"05"},{label:"June",value:"06"},{label:"July",value:"07"},{label:"August",value:"08"},{label:"September",value:"09"},{label:"October",value:"10"},{label:"November",value:"11"},{label:"December",value:"12"}],$=[{label:"2021",value:"2021"},{label:"2022",value:"2022"},{label:"2023",value:"2023"},{label:"2024",value:"2024"},{label:"2025",value:"2025"},{label:"2026",value:"2026"},{label:"2027",value:"2027"},{label:"2028",value:"2028"},{label:"2029",value:"2029"},{label:"2030",value:"2030"}];function p(M){f=M,t(0,f)}function E(M){o=M,t(1,o)}const N=()=>c.set(!0);return l.$$.update=()=>{l.$$.dirty&3&&fe(r,n=`${o}-${f}`,n),l.$$.dirty&4&&n&&d()},[f,o,n,i,s,r,c,u,$,p,E,N]}class Cl extends Ee{constructor(e){super(),De(this,e,Dl,El,Ce,{})}}function Il(l){let e,t,n,i,s,r,c,a,f,o,d;t=new ye({props:{icon:hn,class:"text-2xl",tooltip:"Add event"}}),t.$on("click",l[9]);function u(p){l[10](p)}let $={class:"ml-auto",options:[{label:"Upcoming",value:"upcoming"},{label:"Monthly view",value:"month"}]};return l[0]!==void 0&&($.value=l[0]),i=new xe({props:$}),ve.push(()=>ke(i,"value",u)),c=new ye({props:{tooltip:"Refresh events",icon:l[1]?He:pt,class:l[1]?"animate-spin text-xl":"text-xl"}}),c.$on("click",l[11]),f=new ye({props:{tooltip:"Settings",icon:vn,class:"text-xl"}}),f.$on("click",l[12]),{c(){e=v("div"),I(t.$$.fragment),n=V(),I(i.$$.fragment),r=V(),I(c.$$.fragment),a=V(),I(f.$$.fragment),b(e,"class","flex items-center shrink-0 justify-start py-1 px-2 mt-2.5 gap-4")},m(p,E){y(p,e,E),S(t,e,null),g(e,n),S(i,e,null),g(e,r),S(c,e,null),g(e,a),S(f,e,null),d=!0},p(p,[E]){const N={};!s&&E&1&&(s=!0,N.value=p[0],we(()=>s=!1)),i.$set(N);const M={};E&2&&(M.icon=p[1]?He:pt),E&2&&(M.class=p[1]?"animate-spin text-xl":"text-xl"),c.$set(M)},i(p){d||(m(t.$$.fragment,p),m(i.$$.fragment,p),m(c.$$.fragment,p),m(f.$$.fragment,p),p&&ln(()=>{d&&(o||(o=it(e,Mt,{duration:400},!0)),o.run(1))}),d=!0)},o(p){_(t.$$.fragment,p),_(i.$$.fragment,p),_(c.$$.fragment,p),_(f.$$.fragment,p),p&&(o||(o=it(e,Mt,{duration:400},!1)),o.run(0)),d=!1},d(p){p&&T(e),Y(t),Y(i),Y(c),Y(f),p&&o&&o.end()}}}function Sl(l,e,t){let n,i,s;const{isCreate:r,selectedView:c,isUpdating:a,isSettings:f}=$e("stores");R(l,c,N=>t(0,n=N)),R(l,a,N=>t(1,i=N)),R(l,f,N=>t(2,s=N));const{fetchUpcomingEvents:o,fetchMonthlyEvents:d}=$e("utils"),u=()=>r.set(!0);function $(N){n=N,c.set(n)}return[n,i,s,r,c,a,f,o,d,u,$,()=>n==="upcoming"?o():d(),()=>fe(f,s=!0,s)]}class Yl extends Ee{constructor(e){super(),De(this,e,Sl,Il,Ce,{})}}function zt(l,e,t){const n=l.slice();return n[25]=e[t],n}function Nl(l){let e,t;return e=new ye({props:{icon:pt,class:"ml-2",tooltip:"Refresh calendars"}}),e.$on("click",l[16]),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p:be,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function Ul(l){let e,t;return e=new yn({props:{class:"ml-2 text-lg"}}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p:be,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function Jt(l,e){let t,n,i,s,r=e[25].name+"",c,a,f;function o(){return e[23](e[25])}return n=new wn({props:{round:!0,filled:!0,size:"1.15",checked:!e[7].includes(e[25].id),disabled:e[6].filter(e[22]).length===1}}),n.$on("change",o),{key:l,first:null,c(){t=v("div"),I(n.$$.fragment),i=V(),s=v("span"),c=Q(r),a=V(),b(s,"class","text-sm"),b(t,"class","flex items-center gap-3"),this.first=t},m(d,u){y(d,t,u),S(n,t,null),g(t,i),g(t,s),g(s,c),g(t,a),f=!0},p(d,u){e=d;const $={};u&192&&($.checked=!e[7].includes(e[25].id)),u&192&&($.disabled=e[6].filter(e[22]).length===1),n.$set($),(!f||u&64)&&r!==(r=e[25].name+"")&&Te(c,r)},i(d){f||(m(n.$$.fragment,d),f=!0)},o(d){_(n.$$.fragment,d),f=!1},d(d){d&&T(t),Y(n)}}}function jl(l){let e,t,n,i,s,r,c,a,f,o,d,u,$,p,E,N,M,C,w,X,G,B,z,O,Z,J,F=[],L=new Map,te,re,ne;n=new ye({props:{icon:mt,class:"text-xl"}}),n.$on("click",l[19]),c=new Rn({props:{integration:{...l[1].find(qt),id:l[17]}}}),u=new xe({props:{options:[{label:"Never",value:!1},{label:"5 mins before",value:5},{label:"10 mins before",value:10},{label:"15 mins before",value:15},{label:"30 mins before",value:30}],value:l[2]?l[3]:!1}}),u.$on("change",l[20]),M=new xe({props:{options:[{label:"Next one day",value:1},{label:"Next three days",value:3},{label:"Next five days",value:5},{label:"Next one week",value:7},{label:"Next two weeks",value:14},{label:"Next one month",value:30},{label:"Next three months",value:90}],value:l[4]}}),M.$on("change",l[21]);const le=[Ul,Nl],D=[];function H(U,k){return U[5]?0:1}B=H(l),z=D[B]=le[B](l);let q=l[6];const pe=U=>U[25].id;for(let U=0;U<q.length;U+=1){let k=zt(l,q,U),h=pe(k);L.set(h,F[U]=Jt(h,k))}return{c(){e=v("div"),t=v("div"),I(n.$$.fragment),i=V(),s=v("span"),s.textContent="Exit Settings",r=V(),I(c.$$.fragment),a=V(),f=v("div"),o=v("span"),o.textContent="Send notifications",d=V(),I(u.$$.fragment),$=V(),p=v("div"),E=v("span"),E.textContent="Show events for",N=V(),I(M.$$.fragment),C=V(),w=v("div"),X=v("span"),G=Q(`Available Calendars

      `),z.c(),O=V(),Z=v("div"),J=v("div");for(let U=0;U<F.length;U+=1)F[U].c();b(s,"class","text-base"),b(t,"class","flex justify-start items-center gap-3 mb-2"),b(o,"class","w-32 text-sm"),b(f,"class","mt-2 flex items-center gap-3"),b(E,"class","w-32 text-sm"),b(p,"class","flex items-center gap-3"),b(X,"class","mb-2 flex items-center gap-2 font-medium"),b(J,"class","flex h-full flex-col gap-3"),b(w,"class","mt-2 flex flex-col gap-2 h-full overflow-hidden"),b(e,"class","flex h-full flex-col overflow-hidden gap-4 px-3 py-2")},m(U,k){y(U,e,k),g(e,t),S(n,t,null),g(t,i),g(t,s),g(e,r),S(c,e,null),g(e,a),g(e,f),g(f,o),g(f,d),S(u,f,null),g(e,$),g(e,p),g(p,E),g(p,N),S(M,p,null),g(e,C),g(e,w),g(w,X),g(X,G),D[B].m(X,null),g(w,O),g(w,Z),g(Z,J);for(let h=0;h<F.length;h+=1)F[h]&&F[h].m(J,null);te=!0,re||(ne=[st(window,"keydown",l[18]),Ye(et.call(null,Z))],re=!0)},p(U,[k]){const h={};k&2&&(h.integration={...U[1].find(qt),id:U[17]}),c.$set(h);const K={};k&12&&(K.value=U[2]?U[3]:!1),u.$set(K);const ee={};k&16&&(ee.value=U[4]),M.$set(ee);let me=B;B=H(U),B===me?D[B].p(U,k):(ie(),_(D[me],1,1,()=>{D[me]=null}),se(),z=D[B],z?z.p(U,k):(z=D[B]=le[B](U),z.c()),m(z,1),z.m(X,null)),k&16576&&(q=U[6],ie(),F=Ze(F,k,pe,1,U,q,L,J,Ke,Jt,null,zt),se())},i(U){if(!te){m(n.$$.fragment,U),m(c.$$.fragment,U),m(u.$$.fragment,U),m(M.$$.fragment,U),m(z);for(let k=0;k<q.length;k+=1)m(F[k]);te=!0}},o(U){_(n.$$.fragment,U),_(c.$$.fragment,U),_(u.$$.fragment,U),_(M.$$.fragment,U),_(z);for(let k=0;k<F.length;k+=1)_(F[k]);te=!1},d(U){U&&T(e),Y(n),Y(c),Y(u),Y(M),D[B].d();for(let k=0;k<F.length;k+=1)F[k].d();re=!1,rt(ne)}}}const qt=l=>l.id==="google_calendar";function Vl(l,e,t){let n,i,s,r,c,a,f,o;R(l,kn,L=>t(1,i=L));const{isSettings:d,widgetId:u,minutesBeforeReminder:$,calendars:p,sendNotifications:E,upcomingViewLimit:N,isUpdating:M,unselectedCalenders:C}=$e("stores");R(l,d,L=>t(0,n=L)),R(l,$,L=>t(3,r=L)),R(l,p,L=>t(6,f=L)),R(l,E,L=>t(2,s=L)),R(l,N,L=>t(4,c=L)),R(l,M,L=>t(5,a=L)),R(l,C,L=>t(7,o=L));const{fetchUpcomingEvents:w,getCalendars:X}=$e("utils"),G=u==="calendar"?"google_calendar":`google_calendar_${u}`;return[n,i,s,r,c,a,f,o,d,$,p,E,N,M,C,w,X,G,L=>{L.key==="Escape"&&fe(d,n=!1,n)},()=>fe(d,n=!1,n),L=>{L.detail===!1?E.set(!1):(E.set(!0),fe($,r=L.detail,r))},L=>{L.detail>c?(N.set(L.detail),w()):N.set(L.detail)},L=>!o.includes(L.id),L=>{o.includes(L.id)?C.update(te=>te.filter(re=>re!==L.id)):C.update(te=>[...te,L.id])}]}class Ll extends Ee{constructor(e){super(),De(this,e,Vl,jl,Ce,{})}}function Wt(l,e,t){const n=l.slice();return n[15]=e[t],n}function Xt(l,e,t){const n=l.slice();return n[15]=e[t],n}function Rl(l){let e,t,n,i=[],s=new Map,r,c,a,f=l[2].length>0&&Zt(l),o=l[1];const d=u=>u[15].id;for(let u=0;u<o.length;u+=1){let $=Wt(l,o,u),p=d($);s.set(p,i[u]=xt(p,$))}return{c(){e=v("div"),t=v("div"),f&&f.c(),n=V();for(let u=0;u<i.length;u+=1)i[u].c();b(t,"class","flex flex-col gap-2 transition-height h-full")},m(u,$){y(u,e,$),g(e,t),f&&f.m(t,null),g(t,n);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(t,null);r=!0,c||(a=Ye(et.call(null,e)),c=!0)},p(u,$){u[2].length>0?f?(f.p(u,$),$&4&&m(f,1)):(f=Zt(u),f.c(),m(f,1),f.m(t,n)):f&&(ie(),_(f,1,1,()=>{f=null}),se()),$&2&&(o=u[1],ie(),i=Ze(i,$,d,1,u,o,s,t,Ke,xt,null,Wt),se())},i(u){if(!r){m(f);for(let $=0;$<o.length;$+=1)m(i[$]);r=!0}},o(u){_(f);for(let $=0;$<i.length;$+=1)_(i[$]);r=!1},d(u){u&&T(e),f&&f.d();for(let $=0;$<i.length;$+=1)i[$].d();c=!1,a()}}}function Ol(l){let e,t,n,i;const s=[Bl,Pl],r=[];function c(a,f){return a[3]?0:1}return t=c(l),n=r[t]=s[t](l),{c(){e=v("div"),n.c(),b(e,"class","flex items-center flex-col justify-center h-full")},m(a,f){y(a,e,f),r[t].m(e,null),i=!0},p(a,f){let o=t;t=c(a),t===o?r[t].p(a,f):(ie(),_(r[o],1,1,()=>{r[o]=null}),se(),n=r[t],n?n.p(a,f):(n=r[t]=s[t](a),n.c()),m(n,1),n.m(e,null))},i(a){i||(m(n),i=!0)},o(a){_(n),i=!1},d(a){a&&T(e),r[t].d()}}}function Zt(l){let e,t,n=[],i=new Map,s,r,c,a=l[2];const f=d=>d[15].id;for(let d=0;d<a.length;d+=1){let u=Xt(l,a,d),$=f(u);i.set($,n[d]=Kt($,u))}let o=l[1].length>0&&Qt();return{c(){e=v("span"),e.textContent="Today",t=V();for(let d=0;d<n.length;d+=1)n[d].c();s=V(),o&&o.c(),r=Me(),b(e,"class","ml-1.5 mt-1 text-start text-[0.9rem] font-medium")},m(d,u){y(d,e,u),y(d,t,u);for(let $=0;$<n.length;$+=1)n[$]&&n[$].m(d,u);y(d,s,u),o&&o.m(d,u),y(d,r,u),c=!0},p(d,u){u&4&&(a=d[2],ie(),n=Ze(n,u,f,1,d,a,i,s.parentNode,Ke,Kt,s,Xt),se()),d[1].length>0?o||(o=Qt(),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},i(d){if(!c){for(let u=0;u<a.length;u+=1)m(n[u]);c=!0}},o(d){for(let u=0;u<n.length;u+=1)_(n[u]);c=!1},d(d){d&&T(e),d&&T(t);for(let u=0;u<n.length;u+=1)n[u].d(d);d&&T(s),o&&o.d(d),d&&T(r)}}}function Kt(l,e){let t,n,i;return n=new _t({props:{event:e[15]}}),{key:l,first:null,c(){t=Me(),I(n.$$.fragment),this.first=t},m(s,r){y(s,t,r),S(n,s,r),i=!0},p(s,r){e=s;const c={};r&4&&(c.event=e[15]),n.$set(c)},i(s){i||(m(n.$$.fragment,s),i=!0)},o(s){_(n.$$.fragment,s),i=!1},d(s){s&&T(t),Y(n,s)}}}function Qt(l){let e;return{c(){e=v("span"),e.textContent="Upcoming",b(e,"class","ml-1.5 mt-1 text-start text-[0.9rem] font-medium")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function xt(l,e){let t,n,i;return n=new _t({props:{event:e[15]}}),{key:l,first:null,c(){t=Me(),I(n.$$.fragment),this.first=t},m(s,r){y(s,t,r),S(n,s,r),i=!0},p(s,r){e=s;const c={};r&2&&(c.event=e[15]),n.$set(c)},i(s){i||(m(n.$$.fragment,s),i=!0)},o(s){_(n.$$.fragment,s),i=!1},d(s){s&&T(t),Y(n,s)}}}function Pl(l){let e,t,n,i,s,r;e=new Ie({props:{icon:rn,class:"text-5xl shrink-0"}});function c(o,d){if(o[4]===1)return ql;if(o[4]<7)return Jl;if(o[4]===7)return zl;if(o[4]===14)return Gl;if(o[4]===30)return Fl;if(o[4]===90)return Hl}let a=c(l),f=a&&a(l);return s=new Xe({props:{class:"mt-4",$$slots:{default:[Wl]},$$scope:{ctx:l}}}),s.$on("click",l[11]),{c(){I(e.$$.fragment),t=V(),n=v("span"),f&&f.c(),i=V(),I(s.$$.fragment),b(n,"class","text-lg flex-center gap-4 mt-6")},m(o,d){S(e,o,d),y(o,t,d),y(o,n,d),f&&f.m(n,null),y(o,i,d),S(s,o,d),r=!0},p(o,d){a===(a=c(o))&&f?f.p(o,d):(f&&f.d(1),f=a&&a(o),f&&(f.c(),f.m(n,null)));const u={};d&1048576&&(u.$$scope={dirty:d,ctx:o}),s.$set(u)},i(o){r||(m(e.$$.fragment,o),m(s.$$.fragment,o),r=!0)},o(o){_(e.$$.fragment,o),_(s.$$.fragment,o),r=!1},d(o){Y(e,o),o&&T(t),o&&T(n),f&&f.d(),o&&T(i),Y(s,o)}}}function Bl(l){let e,t,n,i,s,r,c;return r=new Ie({props:{icon:He,class:"animate-spin text-2xl"}}),{c(){e=v("img"),n=V(),i=v("span"),s=Q("Looking for events "),I(r.$$.fragment),We(e.src,t="/apps/google_calendar.png")||b(e,"src",t),b(e,"class","w-10 h-10"),b(e,"alt","Google Calendar logo"),b(i,"class","text-lg flex-center gap-4 mt-6")},m(a,f){y(a,e,f),y(a,n,f),y(a,i,f),g(i,s),S(r,i,null),c=!0},p:be,i(a){c||(m(r.$$.fragment,a),c=!0)},o(a){_(r.$$.fragment,a),c=!1},d(a){a&&T(e),a&&T(n),a&&T(i),Y(r)}}}function Hl(l){let e;return{c(){e=Q("No events within the next three months ")},m(t,n){y(t,e,n)},p:be,d(t){t&&T(e)}}}function Fl(l){let e;return{c(){e=Q("No events within the next month ")},m(t,n){y(t,e,n)},p:be,d(t){t&&T(e)}}}function Gl(l){let e;return{c(){e=Q("No events within the next two weeks ")},m(t,n){y(t,e,n)},p:be,d(t){t&&T(e)}}}function zl(l){let e;return{c(){e=Q("No events within the next week ")},m(t,n){y(t,e,n)},p:be,d(t){t&&T(e)}}}function Jl(l){let e,t,n;return{c(){e=Q("No events within the next "),t=Q(l[4]),n=Q(" days ")},m(i,s){y(i,e,s),y(i,t,s),y(i,n,s)},p(i,s){s&16&&Te(t,i[4])},d(i){i&&T(e),i&&T(t),i&&T(n)}}}function ql(l){let e;return{c(){e=Q("No events today ")},m(t,n){y(t,e,n)},p:be,d(t){t&&T(e)}}}function Wl(l){let e;return{c(){e=Q("Add event")},m(t,n){y(t,e,n)},d(t){t&&T(e)}}}function Xl(l){let e,t,n,i;const s=[Ol,Rl],r=[];function c(a,f){return a[0].length===0?0:1}return e=c(l),t=r[e]=s[e](l),{c(){t.c(),n=Me()},m(a,f){r[e].m(a,f),y(a,n,f),i=!0},p(a,[f]){let o=e;e=c(a),e===o?r[e].p(a,f):(ie(),_(r[o],1,1,()=>{r[o]=null}),se(),t=r[e],t?t.p(a,f):(t=r[e]=s[e](a),t.c()),m(t,1),t.m(n.parentNode,n))},i(a){i||(m(t),i=!0)},o(a){_(t),i=!1},d(a){r[e].d(a),a&&T(n)}}}function Zl(l,e,t){let n,i,s,r,c,a,f;R(l,ot,C=>t(9,r=C));const{events:o,calendars:d,upcomingViewLimit:u,isCreate:$,lastUpdated:p,isUpdating:E,widgetId:N}=$e("stores");R(l,o,C=>t(10,c=C)),R(l,u,C=>t(4,f=C)),R(l,E,C=>t(3,a=C));const M=()=>$.set(!0);return l.$$.update=()=>{l.$$.dirty&1536&&t(0,n=c.filter(C=>C.isAllDay?j(C.endTime).isAfter(r,"day"):j(C.endTime).isAfter(r))),l.$$.dirty&513&&t(2,i=n.filter(C=>j(C.startTime).isSame(r,"day")).sort((C,w)=>C.startTime.localeCompare(w.startTime))),l.$$.dirty&513&&t(1,s=n.filter(C=>j(C.startTime).isAfter(r,"day")).sort((C,w)=>C.startTime.localeCompare(w.startTime)))},[n,s,i,a,f,o,u,$,E,r,c,M]}class Kl extends Ee{constructor(e){super(),De(this,e,Zl,Xl,Ce,{})}}function Ql(l){let e,t,n,i,s;const r=[li,ni,ti],c=[];function a(o,d){return o[5]?0:o[0]==="upcoming"?1:2}e=a(l),t=c[e]=r[e](l);let f=(l[1]||l[6])&&en();return{c(){t.c(),n=V(),f&&f.c(),i=Me()},m(o,d){c[e].m(o,d),y(o,n,d),f&&f.m(o,d),y(o,i,d),s=!0},p(o,d){let u=e;e=a(o),e!==u&&(ie(),_(c[u],1,1,()=>{c[u]=null}),se(),t=c[e],t||(t=c[e]=r[e](o),t.c()),m(t,1),t.m(n.parentNode,n)),o[1]||o[6]?f?d[0]&66&&m(f,1):(f=en(),f.c(),m(f,1),f.m(i.parentNode,i)):f&&(ie(),_(f,1,1,()=>{f=null}),se())},i(o){s||(m(t),m(f),s=!0)},o(o){_(t),_(f),s=!1},d(o){c[e].d(o),o&&T(n),f&&f.d(o),o&&T(i)}}}function xl(l){let e,t;return e=new Ll({}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p:be,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ei(l){let e,t;return e=new bl({}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p:be,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ti(l){let e,t;return e=new Cl({}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ni(l){let e,t;return e=new Kl({}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function li(l){let e,t;return e=new al({}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function en(l){let e,t;return e=new Yl({}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ii(l){let e,t,n,i,s;const r=[ei,xl,Ql],c=[];function a(f,o){return f[2]||f[3]?0:f[4]?1:2}return t=a(l),n=c[t]=r[t](l),{c(){e=v("div"),n.c(),b(e,"class",i="w-[24rem] flex-col justify-between flex px-2 py-2 overflow-hidden "+(l[1]?"h-[40rem]":"h-[24.75rem]")),sn(e,"transition","height 0.2s ease-in-out, max-height 0.2s ease-in-out, min-height 0.2s ease-in-out")},m(f,o){y(f,e,o),c[t].m(e,null),s=!0},p(f,o){let d=t;t=a(f),t===d?c[t].p(f,o):(ie(),_(c[d],1,1,()=>{c[d]=null}),se(),n=c[t],n?n.p(f,o):(n=c[t]=r[t](f),n.c()),m(n,1),n.m(e,null)),(!s||o[0]&2&&i!==(i="w-[24rem] flex-col justify-between flex px-2 py-2 overflow-hidden "+(f[1]?"h-[40rem]":"h-[24.75rem]")))&&b(e,"class",i)},i(f){s||(m(n),s=!0)},o(f){_(n),s=!1},d(f){f&&T(e),c[t].d()}}}function si(l,e,t){let n,i,s,r,c,a,f,o,d,u,$,p,E;const{events:N,calendars:M,monthlyEvents:C,upcomingViewLimit:w,selectedView:X,lastUpdated:G,isUpdating:B,unselectedCalenders:z,widgetId:O,selectedMonth:Z,isCreate:J,isEdit:F,isSettings:L,selectedEvent:te}=$e("stores");R(l,N,k=>t(23,r=k)),R(l,M,k=>t(20,n=k)),R(l,w,k=>t(24,c=k)),R(l,X,k=>t(0,a=k)),R(l,G,k=>t(25,f=k)),R(l,z,k=>t(22,s=k)),R(l,Z,k=>t(21,i=k)),R(l,J,k=>t(2,d=k)),R(l,F,k=>t(3,u=k)),R(l,L,k=>t(4,$=k)),R(l,te,k=>t(5,p=k));const re=$e("alwaysAppView");R(l,re,k=>t(1,o=k));const ne=$e("appActive");R(l,ne,k=>t(6,E=k));const le=D();Tn(()=>{le()}),Mn(async()=>{j(f).add(5,"minutes").isAfter(j())||(n.length===0&&await pe(),a==="upcoming"?H():q())});function D(){const k=setInterval(()=>{a==="upcoming"?H():q()},3e5);return()=>clearInterval(k)}const H=async()=>{B.set(!0);let k=await U({start:j().startOf("day").toISOString(),end:j().add(c,"days").endOf("day").toISOString(),calendars:n.map(h=>h.id).filter(h=>!s.includes(h))});k&&(k=k.map(h=>{const K=r.find(ee=>ee.id===h.id);return K&&(h.reminderSent=K.reminderSent),h}),fe(N,r=k,r)),B.set(!1),G.set(j().valueOf())},q=async()=>{B.set(!0);try{const k=await U({start:j(i).startOf("month").toISOString(),end:j(i).endOf("month").toISOString(),calendars:n.map(h=>h.id).filter(h=>!s.includes(h))});k&&C.update(h=>(h[i]={events:k,lastUpdated:j().valueOf()},h)),B.set(!1),G.set(j().valueOf())}catch(k){console.error(k),B.set(!1)}},pe=async()=>{B.set(!0);try{const{data:k}=await qe.get("/integration/google_calendar/list_calendars",{params:{widgetId:O==="calendar"?"":O}});B.set(!1),fe(M,n=k.calendars,n)}catch(k){console.error(k),B.set(!1)}},U=async({start:k,end:h,calendars:K})=>{const{data:ee}=await qe.get("/integration/google_calendar/list_events",{params:{start:k,end:h,calendars:K.join(","),widgetId:O==="calendar"?"":O}});return ee.events};return on("utils",{getEvents:U,getCalendars:pe,fetchUpcomingEvents:H,fetchMonthlyEvents:q}),[a,o,d,u,$,p,E,N,M,w,X,G,z,Z,J,F,L,te,re,ne]}class ri extends Ee{constructor(e){super(),De(this,e,si,ii,Ce,{},null,[-1,-1])}}function oi(l,e,t){let n,i,s,r;R(l,ot,u=>t(3,s=u));const{minutesBeforeReminder:c,sendNotifications:a,events:f}=$e("stores");R(l,c,u=>t(5,n=u)),R(l,a,u=>t(4,r=u)),R(l,f,u=>t(6,i=u));const o=u=>{let $=[];fe(f,i=i.map(p=>(p.reminderSent||j(p.startTime).isBefore(j(u).add(n,"minutes"))&&($.push(p),p.reminderSent=!0),p)),i),$.length>0&&$.forEach(p=>{d(p)})},d=u=>{const $={id:u.id,title:u.subject||"Untitled event",body:u.isMeeting?"Click to join the meeting now!":u.isAllDay?"All day":`Event starting in ${n} minutes!`,app:"google_calendar",...u.isMeeting?{icon:`/apps/${u.meetingProvider}.svg`}:{icon:"/apps/google_calendar.png"},action:"launchUrl",actionData:u.isMeeting?u.meetingUrl:u.url,...u.isAllDay?{}:{dueIn:u.startTime},timestamp:Date.now(),expiry:u.isAllDay?j().endOf("day").toISOString():u.endTime};An($)};return l.$$.update=()=>{l.$$.dirty&24&&r&&o(s)},[c,a,f,s,r]}class ai extends Ee{constructor(e){super(),De(this,e,oi,null,Ce,{})}}function fi(l){let e,t;return e=new Sn({}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p:be,i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function ci(l){let e,t,n,i;const s=[di,ui],r=[];function c(a,f){return a[1]?0:1}return e=c(l),t=r[e]=s[e](l),{c(){t.c(),n=Me()},m(a,f){r[e].m(a,f),y(a,n,f),i=!0},p(a,f){let o=e;e=c(a),e===o?r[e].p(a,f):(ie(),_(r[o],1,1,()=>{r[o]=null}),se(),t=r[e],t?t.p(a,f):(t=r[e]=s[e](a),t.c()),m(t,1),t.m(n.parentNode,n))},i(a){i||(m(t),i=!0)},o(a){_(t),i=!1},d(a){r[e].d(a),a&&T(n)}}}function ui(l){let e,t;return e=new Hn({props:{widgetId:l[0].id}}),{c(){I(e.$$.fragment)},m(n,i){S(e,n,i),t=!0},p(n,i){const s={};i[0]&1&&(s.widgetId=n[0].id),e.$set(s)},i(n){t||(m(e.$$.fragment,n),t=!0)},o(n){_(e.$$.fragment,n),t=!1},d(n){Y(e,n)}}}function di(l){let e,t,n,i;return e=new ri({}),n=new ai({}),{c(){I(e.$$.fragment),t=V(),I(n.$$.fragment)},m(s,r){S(e,s,r),y(s,t,r),S(n,s,r),i=!0},p:be,i(s){i||(m(e.$$.fragment,s),m(n.$$.fragment,s),i=!0)},o(s){_(e.$$.fragment,s),_(n.$$.fragment,s),i=!1},d(s){Y(e,s),s&&T(t),Y(n,s)}}}function pi(l){let e,t,n,i;const s=[ci,fi],r=[];function c(a,f){return a[2]?0:1}return e=c(l),t=r[e]=s[e](l),{c(){t.c(),n=Me()},m(a,f){r[e].m(a,f),y(a,n,f),i=!0},p(a,f){let o=e;e=c(a),e===o?r[e].p(a,f):(ie(),_(r[o],1,1,()=>{r[o]=null}),se(),t=r[e],t?t.p(a,f):(t=r[e]=s[e](a),t.c()),m(t,1),t.m(n.parentNode,n))},i(a){i||(m(t),i=!0)},o(a){_(t),i=!1},d(a){r[e].d(a),a&&T(n)}}}function mi(l,e,t){let n,i,s,r,c,a,f,o,d,u,$,{config:p}=e;const E={path:`user_data/{uid}/profiles/{currentProfile}/apps_v2/${p.id}`,currentProfile:tn,uid:En},N=p.id==="calendar"?"google_calendar":`google_calendar_${p.id}`;console.log(N);const{create:M,createPersist:C,isFetched:w,start:X,stop:G}=In(E);R(l,w,h=>t(2,$=h));const B=C("lastUpdated",1696020917e3),z=C("events",[]);R(l,z,h=>t(22,d=h));const O=C("monthlyEvents",{});R(l,O,h=>t(21,o=h));const Z=Qe(!1),J=C("calendars",[]);R(l,J,h=>t(20,f=h));const F=M("unselectedCalenders",[]);R(l,F,h=>t(19,a=h));const L=M("selectedView","upcoming");R(l,L,h=>t(18,c=h));const te=M("upcomingViewLimit",7),re=M("selectedMonth",j().format("YYYY-MM")),ne=Qe(null);R(l,ne,h=>t(14,n=h));const le=Qe(!1);R(l,le,h=>t(16,s=h));const D=Qe(!1);R(l,D,h=>t(15,i=h));const H=Qe(!1);R(l,H,h=>t(17,r=h));const q=M("minutesBeforeReminder",5),pe=M("sendNotifications",!0),U=Dn([Cn],([h])=>{const K=h==null?void 0:h[N];return K?K.id:!1});R(l,U,h=>t(1,u=h));const k=()=>{fe(z,d=[],d),fe(O,o={},o),fe(J,f=[],f),fe(F,a=[],a),fe(L,c="upcoming",c),fe(H,r=!1,r),fe(le,s=!1,s),fe(D,i=!1,i),fe(ne,n=null,n),B.set(1696020917e3)};return X(),on("stores",{lastUpdated:B,events:z,isUpdating:Z,calendars:J,unselectedCalenders:F,selectedView:L,upcomingViewLimit:te,selectedMonth:re,selectedEvent:ne,isEdit:le,isCreate:D,isIntegrated:U,widgetId:p.id,integrationId:N,monthlyEvents:O,isSettings:H,minutesBeforeReminder:q,sendNotifications:pe}),l.$$set=h=>{"config"in h&&t(0,p=h.config)},l.$$.update=()=>{l.$$.dirty[0]&6&&$&&!u&&k()},[p,u,$,w,z,O,J,F,L,ne,le,D,H,U]}class wi extends Ee{constructor(e){super(),De(this,e,mi,pi,Ce,{config:0},null,[-1,-1])}}export{wi as default};
